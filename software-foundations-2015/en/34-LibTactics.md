<div id="page">

<div id="header">

</div>

<div id="main">

LibTactics<span class="subtitle">A Collection of Handy General-Purpose Tactics</span> {.libtitle}
=====================================================================================

<div class="code code-tight">

</div>

<div class="doc">

</div>

<div class="code code-tight">

\
 <span
class="comment">(\* Chapter maintained by Arthur Chargueraud \*)</span>\
\

</div>

<div class="doc">

This file contains a set of tactics that extends the set of builtin
tactics provided with the standard distribution of Coq. It intends to
overcome a number of limitations of the standard set of tactics, and
thereby to help user to write shorter and more robust scripts.
<div class="paragraph">

</div>

Hopefully, Coq tactics will be improved as time goes by, and this file
should ultimately be useless. In the meanwhile, serious Coq users will
probably find it very useful.
<div class="paragraph">

</div>

The present file contains the implementation and the detailed
documentation of those tactics. The SF reader need not read this file;
instead, he/she is encouraged to read the chapter named UseTactics.v,
which is gentle introduction to the most useful tactics from the
LibTactic library.
<div class="paragraph">

</div>

The main features offered are:
<div class="paragraph">

</div>

-   More convenient syntax for naming hypotheses, with tactics for
    introduction and inversion that take as input only the name of
    hypotheses of type <span class="inlinecode"><span class="id"
    type="keyword">Prop</span></span>, rather than the name of all
    variables.
-   Tactics providing true support for manipulating N-ary conjunctions,
    disjunctions and existentials, hidding the fact that the underlying
    implementation is based on binary predicates.
-   Convenient support for automation: tactic followed with the symbol
    "\~" or "\*" will call automation on the generated subgoals. Symbol
    "\~" stands for <span class="inlinecode"><span class="id"
    type="tactic">auto</span></span> and "\*" for <span
    class="inlinecode"><span class="id"
    type="tactic">intuition</span></span> <span class="inlinecode"><span
    class="id" type="tactic">eauto</span></span>. These bindings can be
    customized.
-   Forward-chaining tactics are provided to instantiate lemmas either
    with variable or hypotheses or a mix of both.
-   A more powerful implementation of <span class="inlinecode"><span
    class="id" type="tactic">apply</span></span> is provided (it is
    based on <span class="inlinecode"><span class="id"
    type="tactic">refine</span></span> and thus behaves better with
    respect to conversion).
-   An improved inversion tactic which substitutes equalities on
    variables generated by the standard inversion mecanism. Moreover, it
    supports the elimination of dependently-typed equalities (requires
    axiom <span class="inlinecode"><span class="id"
    type="var">K</span></span>, which is a weak form of Proof
    Irrelevance).
-   Tactics for saving time when writing proofs, with tactics to asserts
    hypotheses or sub-goals, and improved tactics for clearing,
    renaming, and sorting hypotheses.

<div class="paragraph">

</div>

External credits:
<div class="paragraph">

</div>

-   thanks to Xavier Leroy for providing the idea of tactic <span
    class="inlinecode"><span class="id"
    type="var">forward</span></span>,
-   thanks to Georges Gonthier for the implementation trick in <span
    class="inlinecode"><span class="id" type="var">rapply</span></span>,

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Set</span> <span class="id"
type="keyword">Implicit</span> <span class="id"
type="var">Arguments</span>.\
\
 <span
class="comment">(\* \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* \*)</span>\

</div>

<div class="doc">

Additional notations for Coq {.section}
============================

</div>

<div class="code code-space">

\
 <span
class="comment">(\* ---------------------------------------------------------------------- \*)</span>\

</div>

<div class="doc">

N-ary Existentials {.section}
------------------

<div class="paragraph">

</div>

<span class="inlinecode"><span
style="font-family: arial;">∃</span></span> <span
class="inlinecode"><span class="id" type="var">T~1~</span></span> <span
class="inlinecode">...</span> <span class="inlinecode"><span class="id"
type="var">TN</span>,</span> <span class="inlinecode"><span class="id"
type="var">P</span></span> is a shorthand for <span
class="inlinecode"><span style="font-family: arial;">∃</span></span>
<span class="inlinecode"><span class="id" type="var">T~1~</span>,</span>
<span class="inlinecode">...,</span> <span class="inlinecode"><span
style="font-family: arial;">∃</span></span> <span
class="inlinecode"><span class="id" type="var">TN</span>,</span> <span
class="inlinecode"><span class="id" type="var">P</span></span>. Note
that <span class="inlinecode"><span class="id"
type="var">Coq.Program.Syntax</span></span> already defines exists for
arity up to 4.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Notation</span> "'exists' x1 ',' P" :=\
   (<span style="font-family: arial;">∃</span><span class="id"
type="var">x1</span>, <span class="id" type="var">P</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 200, <span class="id" type="var">x1</span> <span
class="id" type="var">ident</span>,\
    <span class="id" type="var">right</span> <span class="id"
type="var">associativity</span>) : <span class="id"
type="var">type\_scope</span>.\
 <span class="id" type="keyword">Notation</span> "'exists' x1 x2 ',' P"
:=\
   (<span style="font-family: arial;">∃</span><span class="id"
type="var">x1</span>, <span style="font-family: arial;">∃</span><span
class="id" type="var">x2</span>, <span class="id" type="var">P</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 200, <span class="id" type="var">x1</span> <span
class="id" type="var">ident</span>, <span class="id"
type="var">x2</span> <span class="id" type="var">ident</span>,\
    <span class="id" type="var">right</span> <span class="id"
type="var">associativity</span>) : <span class="id"
type="var">type\_scope</span>.\
 <span class="id" type="keyword">Notation</span> "'exists' x1 x2 x3 ','
P" :=\
   (<span style="font-family: arial;">∃</span><span class="id"
type="var">x1</span>, <span style="font-family: arial;">∃</span><span
class="id" type="var">x2</span>, <span
style="font-family: arial;">∃</span><span class="id"
type="var">x3</span>, <span class="id" type="var">P</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 200, <span class="id" type="var">x1</span> <span
class="id" type="var">ident</span>, <span class="id"
type="var">x2</span> <span class="id" type="var">ident</span>, <span
class="id" type="var">x3</span> <span class="id"
type="var">ident</span>,\
    <span class="id" type="var">right</span> <span class="id"
type="var">associativity</span>) : <span class="id"
type="var">type\_scope</span>.\
 <span class="id" type="keyword">Notation</span> "'exists' x1 x2 x3 x4
',' P" :=\
   (<span style="font-family: arial;">∃</span><span class="id"
type="var">x1</span>, <span style="font-family: arial;">∃</span><span
class="id" type="var">x2</span>, <span
style="font-family: arial;">∃</span><span class="id"
type="var">x3</span>, <span style="font-family: arial;">∃</span><span
class="id" type="var">x4</span>, <span class="id" type="var">P</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 200, <span class="id" type="var">x1</span> <span
class="id" type="var">ident</span>, <span class="id"
type="var">x2</span> <span class="id" type="var">ident</span>, <span
class="id" type="var">x3</span> <span class="id"
type="var">ident</span>, <span class="id" type="var">x4</span> <span
class="id" type="var">ident</span>,\
    <span class="id" type="var">right</span> <span class="id"
type="var">associativity</span>) : <span class="id"
type="var">type\_scope</span>.\
 <span class="id" type="keyword">Notation</span> "'exists' x1 x2 x3 x4
x5 ',' P" :=\
   (<span style="font-family: arial;">∃</span><span class="id"
type="var">x1</span>, <span style="font-family: arial;">∃</span><span
class="id" type="var">x2</span>, <span
style="font-family: arial;">∃</span><span class="id"
type="var">x3</span>, <span style="font-family: arial;">∃</span><span
class="id" type="var">x4</span>, <span
style="font-family: arial;">∃</span><span class="id"
type="var">x5</span>, <span class="id" type="var">P</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 200, <span class="id" type="var">x1</span> <span
class="id" type="var">ident</span>, <span class="id"
type="var">x2</span> <span class="id" type="var">ident</span>, <span
class="id" type="var">x3</span> <span class="id"
type="var">ident</span>, <span class="id" type="var">x4</span> <span
class="id" type="var">ident</span>, <span class="id"
type="var">x5</span> <span class="id" type="var">ident</span>,\
    <span class="id" type="var">right</span> <span class="id"
type="var">associativity</span>) : <span class="id"
type="var">type\_scope</span>.\
 <span class="id" type="keyword">Notation</span> "'exists' x1 x2 x3 x4
x5 x6 ',' P" :=\
   (<span style="font-family: arial;">∃</span><span class="id"
type="var">x1</span>, <span style="font-family: arial;">∃</span><span
class="id" type="var">x2</span>, <span
style="font-family: arial;">∃</span><span class="id"
type="var">x3</span>, <span style="font-family: arial;">∃</span><span
class="id" type="var">x4</span>, <span
style="font-family: arial;">∃</span><span class="id"
type="var">x5</span>, <span style="font-family: arial;">∃</span><span
class="id" type="var">x6</span>, <span class="id" type="var">P</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 200, <span class="id" type="var">x1</span> <span
class="id" type="var">ident</span>, <span class="id"
type="var">x2</span> <span class="id" type="var">ident</span>, <span
class="id" type="var">x3</span> <span class="id"
type="var">ident</span>, <span class="id" type="var">x4</span> <span
class="id" type="var">ident</span>, <span class="id"
type="var">x5</span> <span class="id" type="var">ident</span>,\
    <span class="id" type="var">x6</span> <span class="id"
type="var">ident</span>,\
    <span class="id" type="var">right</span> <span class="id"
type="var">associativity</span>) : <span class="id"
type="var">type\_scope</span>.\
 <span class="id" type="keyword">Notation</span> "'exists' x1 x2 x3 x4
x5 x6 x7 ',' P" :=\
   (<span style="font-family: arial;">∃</span><span class="id"
type="var">x1</span>, <span style="font-family: arial;">∃</span><span
class="id" type="var">x2</span>, <span
style="font-family: arial;">∃</span><span class="id"
type="var">x3</span>, <span style="font-family: arial;">∃</span><span
class="id" type="var">x4</span>, <span
style="font-family: arial;">∃</span><span class="id"
type="var">x5</span>, <span style="font-family: arial;">∃</span><span
class="id" type="var">x6</span>,\
    <span style="font-family: arial;">∃</span><span class="id"
type="var">x7</span>, <span class="id" type="var">P</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 200, <span class="id" type="var">x1</span> <span
class="id" type="var">ident</span>, <span class="id"
type="var">x2</span> <span class="id" type="var">ident</span>, <span
class="id" type="var">x3</span> <span class="id"
type="var">ident</span>, <span class="id" type="var">x4</span> <span
class="id" type="var">ident</span>, <span class="id"
type="var">x5</span> <span class="id" type="var">ident</span>,\
    <span class="id" type="var">x6</span> <span class="id"
type="var">ident</span>, <span class="id" type="var">x7</span> <span
class="id" type="var">ident</span>,\
    <span class="id" type="var">right</span> <span class="id"
type="var">associativity</span>) : <span class="id"
type="var">type\_scope</span>.\
 <span class="id" type="keyword">Notation</span> "'exists' x1 x2 x3 x4
x5 x6 x7 x8 ',' P" :=\
   (<span style="font-family: arial;">∃</span><span class="id"
type="var">x1</span>, <span style="font-family: arial;">∃</span><span
class="id" type="var">x2</span>, <span
style="font-family: arial;">∃</span><span class="id"
type="var">x3</span>, <span style="font-family: arial;">∃</span><span
class="id" type="var">x4</span>, <span
style="font-family: arial;">∃</span><span class="id"
type="var">x5</span>, <span style="font-family: arial;">∃</span><span
class="id" type="var">x6</span>,\
    <span style="font-family: arial;">∃</span><span class="id"
type="var">x7</span>, <span style="font-family: arial;">∃</span><span
class="id" type="var">x8</span>, <span class="id" type="var">P</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 200, <span class="id" type="var">x1</span> <span
class="id" type="var">ident</span>, <span class="id"
type="var">x2</span> <span class="id" type="var">ident</span>, <span
class="id" type="var">x3</span> <span class="id"
type="var">ident</span>, <span class="id" type="var">x4</span> <span
class="id" type="var">ident</span>, <span class="id"
type="var">x5</span> <span class="id" type="var">ident</span>,\
    <span class="id" type="var">x6</span> <span class="id"
type="var">ident</span>, <span class="id" type="var">x7</span> <span
class="id" type="var">ident</span>, <span class="id"
type="var">x8</span> <span class="id" type="var">ident</span>,\
    <span class="id" type="var">right</span> <span class="id"
type="var">associativity</span>) : <span class="id"
type="var">type\_scope</span>.\
 <span class="id" type="keyword">Notation</span> "'exists' x1 x2 x3 x4
x5 x6 x7 x8 x9 ',' P" :=\
   (<span style="font-family: arial;">∃</span><span class="id"
type="var">x1</span>, <span style="font-family: arial;">∃</span><span
class="id" type="var">x2</span>, <span
style="font-family: arial;">∃</span><span class="id"
type="var">x3</span>, <span style="font-family: arial;">∃</span><span
class="id" type="var">x4</span>, <span
style="font-family: arial;">∃</span><span class="id"
type="var">x5</span>, <span style="font-family: arial;">∃</span><span
class="id" type="var">x6</span>,\
    <span style="font-family: arial;">∃</span><span class="id"
type="var">x7</span>, <span style="font-family: arial;">∃</span><span
class="id" type="var">x8</span>, <span
style="font-family: arial;">∃</span><span class="id"
type="var">x9</span>, <span class="id" type="var">P</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 200, <span class="id" type="var">x1</span> <span
class="id" type="var">ident</span>, <span class="id"
type="var">x2</span> <span class="id" type="var">ident</span>, <span
class="id" type="var">x3</span> <span class="id"
type="var">ident</span>, <span class="id" type="var">x4</span> <span
class="id" type="var">ident</span>, <span class="id"
type="var">x5</span> <span class="id" type="var">ident</span>,\
    <span class="id" type="var">x6</span> <span class="id"
type="var">ident</span>, <span class="id" type="var">x7</span> <span
class="id" type="var">ident</span>, <span class="id"
type="var">x8</span> <span class="id" type="var">ident</span>, <span
class="id" type="var">x9</span> <span class="id"
type="var">ident</span>,\
    <span class="id" type="var">right</span> <span class="id"
type="var">associativity</span>) : <span class="id"
type="var">type\_scope</span>.\
 <span class="id" type="keyword">Notation</span> "'exists' x1 x2 x3 x4
x5 x6 x7 x8 x9 x10 ',' P" :=\
   (<span style="font-family: arial;">∃</span><span class="id"
type="var">x1</span>, <span style="font-family: arial;">∃</span><span
class="id" type="var">x2</span>, <span
style="font-family: arial;">∃</span><span class="id"
type="var">x3</span>, <span style="font-family: arial;">∃</span><span
class="id" type="var">x4</span>, <span
style="font-family: arial;">∃</span><span class="id"
type="var">x5</span>, <span style="font-family: arial;">∃</span><span
class="id" type="var">x6</span>,\
    <span style="font-family: arial;">∃</span><span class="id"
type="var">x7</span>, <span style="font-family: arial;">∃</span><span
class="id" type="var">x8</span>, <span
style="font-family: arial;">∃</span><span class="id"
type="var">x9</span>, <span style="font-family: arial;">∃</span><span
class="id" type="var">x10</span>, <span class="id" type="var">P</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 200, <span class="id" type="var">x1</span> <span
class="id" type="var">ident</span>, <span class="id"
type="var">x2</span> <span class="id" type="var">ident</span>, <span
class="id" type="var">x3</span> <span class="id"
type="var">ident</span>, <span class="id" type="var">x4</span> <span
class="id" type="var">ident</span>, <span class="id"
type="var">x5</span> <span class="id" type="var">ident</span>,\
    <span class="id" type="var">x6</span> <span class="id"
type="var">ident</span>, <span class="id" type="var">x7</span> <span
class="id" type="var">ident</span>, <span class="id"
type="var">x8</span> <span class="id" type="var">ident</span>, <span
class="id" type="var">x9</span> <span class="id"
type="var">ident</span>, <span class="id" type="var">x10</span> <span
class="id" type="var">ident</span>,\
    <span class="id" type="var">right</span> <span class="id"
type="var">associativity</span>) : <span class="id"
type="var">type\_scope</span>.\
\
 <span
class="comment">(\* \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* \*)</span>\

</div>

<div class="doc">

Tools for programming with Ltac {.section}
===============================

</div>

<div class="code code-space">

\
 <span
class="comment">(\* ---------------------------------------------------------------------- \*)</span>\

</div>

<div class="doc">

Identity continuation {.section}
---------------------

</div>

<div class="code code-space">

\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">idcont</span> <span class="id" type="var">tt</span> :=\
   <span class="id" type="var">idtac</span>.\
\
 <span
class="comment">(\* ---------------------------------------------------------------------- \*)</span>\

</div>

<div class="doc">

Untyped arguments for tactics {.section}
-----------------------------

<div class="paragraph">

</div>

Any Coq value can be boxed into the type <span class="inlinecode"><span
class="id" type="var">Boxer</span></span>. This is useful to use Coq
computations for implementing tactics.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Inductive</span> <span class="id"
type="var">Boxer</span> : <span class="id" type="keyword">Type</span>
:=\
   | <span class="id" type="var">boxer</span> : <span
style="font-family: arial;">∀</span>(<span class="id"
type="var">A</span>:<span class="id" type="keyword">Type</span>), <span
class="id" type="var">A</span> <span
style="font-family: arial;">→</span> <span class="id"
type="var">Boxer</span>.\
\
 <span
class="comment">(\* ---------------------------------------------------------------------- \*)</span>\

</div>

<div class="doc">

Optional arguments for tactics {.section}
------------------------------

<div class="paragraph">

</div>

<span class="inlinecode"><span class="id"
type="var">ltac\_no\_arg</span></span> is a constant that can be used to
simulate optional arguments in tactic definitions. Use <span
class="inlinecode"><span class="id" type="var">mytactic</span></span>
<span class="inlinecode"><span class="id"
type="var">ltac\_no\_arg</span></span> on the tactic invokation, and use
<span class="inlinecode"><span class="id"
type="keyword">match</span></span> <span class="inlinecode"><span
class="id" type="var">arg</span></span> <span class="inlinecode"><span
class="id" type="keyword">with</span></span> <span
class="inlinecode"><span class="id"
type="var">ltac\_no\_arg</span></span> <span class="inlinecode">⇒</span>
<span class="inlinecode">..</span> or <span class="inlinecode"><span
class="id" type="keyword">match</span></span> <span
class="inlinecode"><span class="id" type="var">type</span></span> <span
class="inlinecode"><span class="id" type="var">of</span></span> <span
class="inlinecode"><span class="id" type="var">arg</span></span> <span
class="inlinecode"><span class="id" type="keyword">with</span></span>
<span class="inlinecode"><span class="id"
type="var">ltac\_No\_arg</span></span> <span class="inlinecode">⇒</span>
<span class="inlinecode">..</span> to test whether an argument was
provided.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Inductive</span> <span class="id"
type="var">ltac\_No\_arg</span> : <span class="id"
type="keyword">Set</span> :=\
   | <span class="id" type="var">ltac\_no\_arg</span> : <span class="id"
type="var">ltac\_No\_arg</span>.\
\
 <span
class="comment">(\* ---------------------------------------------------------------------- \*)</span>\

</div>

<div class="doc">

Wildcard arguments for tactics {.section}
------------------------------

<div class="paragraph">

</div>

<span class="inlinecode"><span class="id"
type="var">ltac\_wild</span></span> is a constant that can be used to
simulate wildcard arguments in tactic definitions. Notation is <span
class="inlinecode"><span class="id" type="var">\_\_</span></span>.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Inductive</span> <span class="id"
type="var">ltac\_Wild</span> : <span class="id"
type="keyword">Set</span> :=\
   | <span class="id" type="var">ltac\_wild</span> : <span class="id"
type="var">ltac\_Wild</span>.\
\
 <span class="id" type="keyword">Notation</span> "'\_\_'" := <span
class="id" type="var">ltac\_wild</span> : <span class="id"
type="var">ltac\_scope</span>.\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id"
type="var">ltac\_wilds</span></span> is another constant that is
typically used to simulate a sequence of <span class="inlinecode"><span
class="id" type="var">N</span></span> wildcards, with <span
class="inlinecode"><span class="id" type="var">N</span></span> chosen
appropriately depending on the context. Notation is <span
class="inlinecode"><span class="id" type="var">\_\_\_</span></span>.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Inductive</span> <span class="id"
type="var">ltac\_Wilds</span> : <span class="id"
type="keyword">Set</span> :=\
   | <span class="id" type="var">ltac\_wilds</span> : <span class="id"
type="var">ltac\_Wilds</span>.\
\
 <span class="id" type="keyword">Notation</span> "'\_\_\_'" := <span
class="id" type="var">ltac\_wilds</span> : <span class="id"
type="var">ltac\_scope</span>.\
\
 <span class="id" type="keyword">Open</span> <span class="id"
type="keyword">Scope</span> <span class="id"
type="var">ltac\_scope</span>.\
\
 <span
class="comment">(\* ---------------------------------------------------------------------- \*)</span>\

</div>

<div class="doc">

Position markers {.section}
----------------

<div class="paragraph">

</div>

<span class="inlinecode"><span class="id"
type="var">ltac\_Mark</span></span> and <span class="inlinecode"><span
class="id" type="var">ltac\_mark</span></span> are dummy definitions
used as sentinel by tactics, to mark a certain position in the context
or in the goal.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Inductive</span> <span class="id"
type="var">ltac\_Mark</span> : <span class="id"
type="keyword">Type</span> :=\
   | <span class="id" type="var">ltac\_mark</span> : <span class="id"
type="var">ltac\_Mark</span>.\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id"
type="var">gen\_until\_mark</span></span> repeats <span
class="inlinecode"><span class="id"
type="tactic">generalize</span></span> on hypotheses from the context,
starting from the bottom and stopping as soon as reaching an hypothesis
of type <span class="inlinecode"><span class="id"
type="var">Mark</span></span>. If fails if <span
class="inlinecode"><span class="id" type="var">Mark</span></span> does
not appear in the context.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">gen\_until\_mark</span> :=\
   <span class="id" type="keyword">match</span> <span class="id"
type="var">goal</span> <span class="id" type="keyword">with</span> <span
class="id" type="var">H</span>: ?<span class="id" type="var">T</span>
<span style="font-family: arial;">⊢</span> <span class="id"
type="var">\_</span> ⇒\
   <span class="id" type="keyword">match</span> <span class="id"
type="var">T</span> <span class="id" type="keyword">with</span>\
   | <span class="id" type="var">ltac\_Mark</span> ⇒ <span class="id"
type="tactic">clear</span> <span class="id" type="var">H</span>\
   | <span class="id" type="var">\_</span> ⇒ <span class="id"
type="tactic">generalize</span> <span class="id" type="var">H</span>;
<span class="id" type="tactic">clear</span> <span class="id"
type="var">H</span>; <span class="id"
type="var">gen\_until\_mark</span>\
   <span class="id" type="keyword">end</span> <span class="id"
type="keyword">end</span>.\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id"
type="var">intro\_until\_mark</span></span> repeats <span
class="inlinecode"><span class="id" type="tactic">intro</span></span>
until reaching an hypothesis of type <span class="inlinecode"><span
class="id" type="var">Mark</span></span>. It throws away the hypothesis
<span class="inlinecode"><span class="id" type="var">Mark</span></span>.
It fails if <span class="inlinecode"><span class="id"
type="var">Mark</span></span> does not appear as an hypothesis in the
goal.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">intro\_until\_mark</span> :=\
   <span class="id" type="keyword">match</span> <span class="id"
type="var">goal</span> <span class="id" type="keyword">with</span>\
   | <span style="font-family: arial;">⊢</span> (<span class="id"
type="var">ltac\_Mark</span> <span style="font-family: arial;">→</span>
<span class="id" type="var">\_</span>) ⇒ <span class="id"
type="tactic">intros</span> <span class="id" type="var">\_</span>\
   | <span class="id" type="var">\_</span> ⇒ <span class="id"
type="tactic">intro</span>; <span class="id"
type="var">intro\_until\_mark</span>\
   <span class="id" type="keyword">end</span>.\
\
 <span
class="comment">(\* ---------------------------------------------------------------------- \*)</span>\

</div>

<div class="doc">

List of arguments for tactics {.section}
-----------------------------

<div class="paragraph">

</div>

A datatype of type <span class="inlinecode"><span class="id"
type="var">list</span></span> <span class="inlinecode"><span class="id"
type="var">Boxer</span></span> is used to manipulate list of Coq values
in ltac. Notation is <span class="inlinecode">\>\></span> <span
class="inlinecode"><span class="id" type="var">v~1~</span></span> <span
class="inlinecode"><span class="id" type="var">v~2~</span></span> <span
class="inlinecode">...</span> <span class="inlinecode"><span class="id"
type="var">vN</span></span> for building a list containing the values
<span class="inlinecode"><span class="id" type="var">v~1~</span></span>
through <span class="inlinecode"><span class="id"
type="var">vN</span></span>.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Require</span> <span class="id"
type="keyword">Import</span> <span class="id" type="var">List</span>.\
\
 <span class="id" type="keyword">Notation</span> "'\>\>'" :=\
   (@<span class="id" type="var">nil</span> <span class="id"
type="var">Boxer</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0)\
   : <span class="id" type="var">ltac\_scope</span>.\
 <span class="id" type="keyword">Notation</span> "'\>\>' v~1~" :=\
   ((<span class="id" type="var">boxer</span> <span class="id"
type="var">v~1~</span>)::<span class="id" type="var">nil</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~1~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0)\
   : <span class="id" type="var">ltac\_scope</span>.\
 <span class="id" type="keyword">Notation</span> "'\>\>' v~1~ v~2~" :=\
   ((<span class="id" type="var">boxer</span> <span class="id"
type="var">v~1~</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v~2~</span>)::<span class="id"
type="var">nil</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~1~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~2~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0)\
   : <span class="id" type="var">ltac\_scope</span>.\
 <span class="id" type="keyword">Notation</span> "'\>\>' v~1~ v~2~ v~3~"
:=\
   ((<span class="id" type="var">boxer</span> <span class="id"
type="var">v~1~</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v~2~</span>)::(<span class="id"
type="var">boxer</span> <span class="id" type="var">v~3~</span>)::<span
class="id" type="var">nil</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~1~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~2~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~3~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0)\
   : <span class="id" type="var">ltac\_scope</span>.\
 <span class="id" type="keyword">Notation</span> "'\>\>' v~1~ v~2~ v~3~
v4" :=\
   ((<span class="id" type="var">boxer</span> <span class="id"
type="var">v~1~</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v~2~</span>)::(<span class="id"
type="var">boxer</span> <span class="id" type="var">v~3~</span>)::(<span
class="id" type="var">boxer</span> <span class="id"
type="var">v4</span>)::<span class="id" type="var">nil</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~1~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~2~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~3~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0,\
    <span class="id" type="var">v4</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0)\
   : <span class="id" type="var">ltac\_scope</span>.\
 <span class="id" type="keyword">Notation</span> "'\>\>' v~1~ v~2~ v~3~
v4 v5" :=\
   ((<span class="id" type="var">boxer</span> <span class="id"
type="var">v~1~</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v~2~</span>)::(<span class="id"
type="var">boxer</span> <span class="id" type="var">v~3~</span>)::(<span
class="id" type="var">boxer</span> <span class="id"
type="var">v4</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v5</span>)::<span class="id"
type="var">nil</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~1~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~2~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~3~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0,\
    <span class="id" type="var">v4</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v5</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0)\
   : <span class="id" type="var">ltac\_scope</span>.\
 <span class="id" type="keyword">Notation</span> "'\>\>' v~1~ v~2~ v~3~
v4 v5 v6" :=\
   ((<span class="id" type="var">boxer</span> <span class="id"
type="var">v~1~</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v~2~</span>)::(<span class="id"
type="var">boxer</span> <span class="id" type="var">v~3~</span>)::(<span
class="id" type="var">boxer</span> <span class="id"
type="var">v4</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v5</span>)\
    ::(<span class="id" type="var">boxer</span> <span class="id"
type="var">v6</span>)::<span class="id" type="var">nil</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~1~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~2~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~3~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0,\
    <span class="id" type="var">v4</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v5</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v6</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0)\
   : <span class="id" type="var">ltac\_scope</span>.\
 <span class="id" type="keyword">Notation</span> "'\>\>' v~1~ v~2~ v~3~
v4 v5 v6 v7" :=\
   ((<span class="id" type="var">boxer</span> <span class="id"
type="var">v~1~</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v~2~</span>)::(<span class="id"
type="var">boxer</span> <span class="id" type="var">v~3~</span>)::(<span
class="id" type="var">boxer</span> <span class="id"
type="var">v4</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v5</span>)\
    ::(<span class="id" type="var">boxer</span> <span class="id"
type="var">v6</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v7</span>)::<span class="id"
type="var">nil</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~1~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~2~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~3~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0,\
    <span class="id" type="var">v4</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v5</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v6</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v7</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0)\
   : <span class="id" type="var">ltac\_scope</span>.\
 <span class="id" type="keyword">Notation</span> "'\>\>' v~1~ v~2~ v~3~
v4 v5 v6 v7 v8" :=\
   ((<span class="id" type="var">boxer</span> <span class="id"
type="var">v~1~</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v~2~</span>)::(<span class="id"
type="var">boxer</span> <span class="id" type="var">v~3~</span>)::(<span
class="id" type="var">boxer</span> <span class="id"
type="var">v4</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v5</span>)\
    ::(<span class="id" type="var">boxer</span> <span class="id"
type="var">v6</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v7</span>)::(<span class="id"
type="var">boxer</span> <span class="id" type="var">v8</span>)::<span
class="id" type="var">nil</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~1~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~2~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~3~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0,\
    <span class="id" type="var">v4</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v5</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v6</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v7</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,\
    <span class="id" type="var">v8</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0)\
   : <span class="id" type="var">ltac\_scope</span>.\
 <span class="id" type="keyword">Notation</span> "'\>\>' v~1~ v~2~ v~3~
v4 v5 v6 v7 v8 v9" :=\
   ((<span class="id" type="var">boxer</span> <span class="id"
type="var">v~1~</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v~2~</span>)::(<span class="id"
type="var">boxer</span> <span class="id" type="var">v~3~</span>)::(<span
class="id" type="var">boxer</span> <span class="id"
type="var">v4</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v5</span>)\
    ::(<span class="id" type="var">boxer</span> <span class="id"
type="var">v6</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v7</span>)::(<span class="id"
type="var">boxer</span> <span class="id" type="var">v8</span>)::(<span
class="id" type="var">boxer</span> <span class="id"
type="var">v9</span>)::<span class="id" type="var">nil</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~1~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~2~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~3~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0,\
    <span class="id" type="var">v4</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v5</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v6</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v7</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,\
    <span class="id" type="var">v8</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v9</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0)\
   : <span class="id" type="var">ltac\_scope</span>.\
 <span class="id" type="keyword">Notation</span> "'\>\>' v~1~ v~2~ v~3~
v4 v5 v6 v7 v8 v9 v10" :=\
   ((<span class="id" type="var">boxer</span> <span class="id"
type="var">v~1~</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v~2~</span>)::(<span class="id"
type="var">boxer</span> <span class="id" type="var">v~3~</span>)::(<span
class="id" type="var">boxer</span> <span class="id"
type="var">v4</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v5</span>)\
    ::(<span class="id" type="var">boxer</span> <span class="id"
type="var">v6</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v7</span>)::(<span class="id"
type="var">boxer</span> <span class="id" type="var">v8</span>)::(<span
class="id" type="var">boxer</span> <span class="id"
type="var">v9</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v10</span>)::<span class="id"
type="var">nil</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~1~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~2~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~3~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0,\
    <span class="id" type="var">v4</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v5</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v6</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v7</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,\
    <span class="id" type="var">v8</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v9</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v10</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0)\
   : <span class="id" type="var">ltac\_scope</span>.\
 <span class="id" type="keyword">Notation</span> "'\>\>' v~1~ v~2~ v~3~
v4 v5 v6 v7 v8 v9 v10 v~11~" :=\
   ((<span class="id" type="var">boxer</span> <span class="id"
type="var">v~1~</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v~2~</span>)::(<span class="id"
type="var">boxer</span> <span class="id" type="var">v~3~</span>)::(<span
class="id" type="var">boxer</span> <span class="id"
type="var">v4</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v5</span>)\
    ::(<span class="id" type="var">boxer</span> <span class="id"
type="var">v6</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v7</span>)::(<span class="id"
type="var">boxer</span> <span class="id" type="var">v8</span>)::(<span
class="id" type="var">boxer</span> <span class="id"
type="var">v9</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v10</span>)\
    ::(<span class="id" type="var">boxer</span> <span class="id"
type="var">v~11~</span>)::<span class="id" type="var">nil</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~1~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~2~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~3~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0,\
    <span class="id" type="var">v4</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v5</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v6</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v7</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,\
    <span class="id" type="var">v8</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v9</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v10</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v~11~</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0)\
   : <span class="id" type="var">ltac\_scope</span>.\
 <span class="id" type="keyword">Notation</span> "'\>\>' v~1~ v~2~ v~3~
v4 v5 v6 v7 v8 v9 v10 v~11~ v~12~" :=\
   ((<span class="id" type="var">boxer</span> <span class="id"
type="var">v~1~</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v~2~</span>)::(<span class="id"
type="var">boxer</span> <span class="id" type="var">v~3~</span>)::(<span
class="id" type="var">boxer</span> <span class="id"
type="var">v4</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v5</span>)\
    ::(<span class="id" type="var">boxer</span> <span class="id"
type="var">v6</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v7</span>)::(<span class="id"
type="var">boxer</span> <span class="id" type="var">v8</span>)::(<span
class="id" type="var">boxer</span> <span class="id"
type="var">v9</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v10</span>)\
    ::(<span class="id" type="var">boxer</span> <span class="id"
type="var">v~11~</span>)::(<span class="id" type="var">boxer</span>
<span class="id" type="var">v~12~</span>)::<span class="id"
type="var">nil</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~1~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~2~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~3~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0,\
    <span class="id" type="var">v4</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v5</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v6</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v7</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,\
    <span class="id" type="var">v8</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v9</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v10</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v~11~</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,\
    <span class="id" type="var">v~12~</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0)\
   : <span class="id" type="var">ltac\_scope</span>.\
 <span class="id" type="keyword">Notation</span> "'\>\>' v~1~ v~2~ v~3~
v4 v5 v6 v7 v8 v9 v10 v~11~ v~12~ v13" :=\
   ((<span class="id" type="var">boxer</span> <span class="id"
type="var">v~1~</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v~2~</span>)::(<span class="id"
type="var">boxer</span> <span class="id" type="var">v~3~</span>)::(<span
class="id" type="var">boxer</span> <span class="id"
type="var">v4</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v5</span>)\
    ::(<span class="id" type="var">boxer</span> <span class="id"
type="var">v6</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v7</span>)::(<span class="id"
type="var">boxer</span> <span class="id" type="var">v8</span>)::(<span
class="id" type="var">boxer</span> <span class="id"
type="var">v9</span>)::(<span class="id" type="var">boxer</span> <span
class="id" type="var">v10</span>)\
    ::(<span class="id" type="var">boxer</span> <span class="id"
type="var">v~11~</span>)::(<span class="id" type="var">boxer</span>
<span class="id" type="var">v~12~</span>)::(<span class="id"
type="var">boxer</span> <span class="id" type="var">v13</span>)::<span
class="id" type="var">nil</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~1~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~2~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">v~3~</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0,\
    <span class="id" type="var">v4</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v5</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v6</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v7</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,\
    <span class="id" type="var">v8</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v9</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v10</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v~11~</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,\
    <span class="id" type="var">v~12~</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0,
<span class="id" type="var">v13</span> <span class="id"
type="tactic">at</span> <span class="id" type="var">level</span> 0)\
   : <span class="id" type="var">ltac\_scope</span>.\
\

</div>

<div class="doc">

The tactic <span class="inlinecode"><span class="id"
type="var">list\_boxer\_of</span></span> inputs a term <span
class="inlinecode"><span class="id" type="var">E</span></span> and
returns a term of type "list boxer", according to the following rules:
<div class="paragraph">

</div>

-   if <span class="inlinecode"><span class="id"
    type="var">E</span></span> is already of type "list Boxer", then it
    returns <span class="inlinecode"><span class="id"
    type="var">E</span></span>;
-   otherwise, it returns the list <span class="inlinecode">(<span
    class="id" type="var">boxer</span></span> <span
    class="inlinecode"><span class="id" type="var">E</span>)::<span
    class="id" type="var">nil</span></span>.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">list\_boxer\_of</span> <span class="id" type="var">E</span>
:=\
   <span class="id" type="keyword">match</span> <span class="id"
type="var">type</span> <span class="id" type="var">of</span> <span
class="id" type="var">E</span> <span class="id"
type="keyword">with</span>\
   | <span class="id" type="var">List.list</span> <span class="id"
type="var">Boxer</span> ⇒ <span class="id"
type="var">constr</span>:(<span class="id" type="var">E</span>)\
   | <span class="id" type="var">\_</span> ⇒ <span class="id"
type="var">constr</span>:((<span class="id" type="var">boxer</span>
<span class="id" type="var">E</span>)::<span class="id"
type="var">nil</span>)\
   <span class="id" type="keyword">end</span>.\
\
 <span
class="comment">(\* ---------------------------------------------------------------------- \*)</span>\

</div>

<div class="doc">

Databases of lemmas {.section}
-------------------

<div class="paragraph">

</div>

Use the hint facility to implement a database mapping terms to terms. To
declare a new database, use a definition: <span class="inlinecode"><span
class="id" type="keyword">Definition</span></span> <span
class="inlinecode"><span class="id" type="var">mydatabase</span></span>
<span class="inlinecode">:=</span> <span class="inlinecode"><span
class="id" type="var">True</span>.</span>
<div class="paragraph">

</div>

Then, to map <span class="inlinecode"><span class="id"
type="var">mykey</span></span> to <span class="inlinecode"><span
class="id" type="var">myvalue</span></span>, write the hint: <span
class="inlinecode"><span class="id" type="keyword">Hint</span></span>
<span class="inlinecode"><span class="id"
type="keyword">Extern</span></span> <span class="inlinecode">1</span>
<span class="inlinecode">(<span class="id"
type="var">Register</span></span> <span class="inlinecode"><span
class="id" type="var">mydatabase</span></span> <span
class="inlinecode"><span class="id" type="var">mykey</span>)</span>
<span class="inlinecode">⇒</span> <span class="inlinecode"><span
class="id" type="var">Provide</span></span> <span
class="inlinecode"><span class="id" type="var">myvalue</span>.</span>
<div class="paragraph">

</div>

Finally, to query the value associated with a key, run the tactic <span
class="inlinecode"><span class="id"
type="var">ltac\_database\_get</span></span> <span
class="inlinecode"><span class="id" type="var">mydatabase</span></span>
<span class="inlinecode"><span class="id"
type="var">mykey</span></span>. This will leave at the head of the goal
the term <span class="inlinecode"><span class="id"
type="var">myvalue</span></span>. It can then be named and exploited
using <span class="inlinecode"><span class="id"
type="tactic">intro</span></span>.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Definition</span> <span class="id"
type="var">ltac\_database</span> (<span class="id"
type="var">D</span>:<span class="id" type="var">Boxer</span>) (<span
class="id" type="var">T</span>:<span class="id" type="var">Boxer</span>)
(<span class="id" type="var">A</span>:<span class="id"
type="var">Boxer</span>) := <span class="id" type="var">True</span>.\
\
 <span class="id" type="keyword">Notation</span> "'Register' D T" :=
(<span class="id" type="var">ltac\_database</span> (<span class="id"
type="var">boxer</span> <span class="id" type="var">D</span>) (<span
class="id" type="var">boxer</span> <span class="id" type="var">T</span>)
<span class="id" type="var">\_</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 69, <span class="id" type="var">D</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0, <span class="id" type="var">T</span> <span
class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 0).\
\
 <span class="id" type="keyword">Lemma</span> <span class="id"
type="var">ltac\_database\_provide</span> : <span
style="font-family: arial;">∀</span>(<span class="id"
type="var">A</span>:<span class="id" type="var">Boxer</span>) (<span
class="id" type="var">D</span>:<span class="id" type="var">Boxer</span>)
(<span class="id" type="var">T</span>:<span class="id"
type="var">Boxer</span>),\
   <span class="id" type="var">ltac\_database</span> <span class="id"
type="var">D</span> <span class="id" type="var">T</span> <span
class="id" type="var">A</span>.\
 <span class="id" type="keyword">Proof</span>. <span class="id"
type="tactic">split</span>. <span class="id" type="keyword">Qed</span>.\
\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">Provide</span> <span class="id" type="var">T</span> := <span
class="id" type="tactic">apply</span> (@<span class="id"
type="var">ltac\_database\_provide</span> (<span class="id"
type="var">boxer</span> <span class="id" type="var">T</span>)).\
\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">ltac\_database\_get</span> <span class="id"
type="var">D</span> <span class="id" type="var">T</span> :=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">A</span> := <span class="id" type="tactic">fresh</span>
"TEMP" <span class="id" type="keyword">in</span> <span class="id"
type="var">evar</span> (<span class="id" type="var">A</span>:<span
class="id" type="var">Boxer</span>);\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">H</span> := <span class="id" type="tactic">fresh</span>
"TEMP" <span class="id" type="keyword">in</span>\
   <span class="id" type="tactic">assert</span> (<span class="id"
type="var">H</span> : <span class="id" type="var">ltac\_database</span>
(<span class="id" type="var">boxer</span> <span class="id"
type="var">D</span>) (<span class="id" type="var">boxer</span> <span
class="id" type="var">T</span>) <span class="id" type="var">A</span>);\
   [ <span class="id" type="tactic">subst</span> <span class="id"
type="var">A</span>; <span class="id" type="tactic">auto</span>\
   | <span class="id" type="tactic">subst</span> <span class="id"
type="var">A</span>; <span class="id" type="keyword">match</span> <span
class="id" type="var">type</span> <span class="id" type="var">of</span>
<span class="id" type="var">H</span> <span class="id"
type="keyword">with</span> <span class="id"
type="var">ltac\_database</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> (<span class="id"
type="var">boxer</span> ?<span class="id" type="var">L</span>) ⇒\
                <span class="id" type="tactic">generalize</span> <span
class="id" type="var">L</span> <span class="id"
type="keyword">end</span>; <span class="id" type="tactic">clear</span>
<span class="id" type="var">H</span> ].\
\
 <span
class="comment">(\* ---------------------------------------------------------------------- \*)</span>\

</div>

<div class="doc">

On-the-fly removal of hypotheses {.section}
--------------------------------

<div class="paragraph">

</div>

In a list of arguments <span class="inlinecode">\>\></span> <span
class="inlinecode"><span class="id" type="var">H1</span></span> <span
class="inlinecode"><span class="id" type="var">H2</span></span> <span
class="inlinecode">..</span> <span class="inlinecode"><span class="id"
type="var">HN</span></span> passed to a tactic such as <span
class="inlinecode"><span class="id" type="var">lets</span></span> or
<span class="inlinecode"><span class="id"
type="var">applys</span></span> or <span class="inlinecode"><span
class="id" type="var">forwards</span></span> or <span
class="inlinecode"><span class="id"
type="var">specializes</span></span>, the term <span
class="inlinecode"><span class="id" type="var">rm</span></span>, an
identity function, can be placed in front of the name of an hypothesis
to be deleted.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Definition</span> <span class="id"
type="var">rm</span> (<span class="id" type="var">A</span>:<span
class="id" type="keyword">Type</span>) (<span class="id"
type="var">X</span>:<span class="id" type="var">A</span>) := <span
class="id" type="var">X</span>.\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id"
type="var">rm\_term</span></span> <span class="inlinecode"><span
class="id" type="var">E</span></span> removes one hypothesis that admits
the same type as <span class="inlinecode"><span class="id"
type="var">E</span></span>.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">rm\_term</span> <span class="id" type="var">E</span> :=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">T</span> := <span class="id" type="var">type</span> <span
class="id" type="var">of</span> <span class="id" type="var">E</span>
<span class="id" type="keyword">in</span>\
   <span class="id" type="keyword">match</span> <span class="id"
type="var">goal</span> <span class="id" type="keyword">with</span> <span
class="id" type="var">H</span>: <span class="id" type="var">T</span>
<span style="font-family: arial;">⊢</span> <span class="id"
type="var">\_</span> ⇒ <span class="id" type="tactic">try</span> <span
class="id" type="tactic">clear</span> <span class="id"
type="var">H</span> <span class="id" type="keyword">end</span>.\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id"
type="var">rm\_inside</span></span> <span class="inlinecode"><span
class="id" type="var">E</span></span> calls <span
class="inlinecode"><span class="id" type="var">rm\_term</span></span>
<span class="inlinecode"><span class="id" type="var">Ei</span></span>
for any subterm of the form <span class="inlinecode"><span class="id"
type="var">rm</span></span> <span class="inlinecode"><span class="id"
type="var">Ei</span></span> found in E

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">rm\_inside</span> <span class="id" type="var">E</span> :=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">go</span> <span class="id" type="var">E</span> := <span
class="id" type="var">rm\_inside</span> <span class="id"
type="var">E</span> <span class="id" type="keyword">in</span>\
   <span class="id" type="keyword">match</span> <span class="id"
type="var">E</span> <span class="id" type="keyword">with</span>\
   | <span class="id" type="var">rm</span> ?<span class="id"
type="var">X</span> ⇒ <span class="id" type="var">rm\_term</span> <span
class="id" type="var">X</span>\
   | ?<span class="id" type="var">X1</span> ?<span class="id"
type="var">X2</span> ⇒\
      <span class="id" type="var">go</span> <span class="id"
type="var">X1</span>; <span class="id" type="var">go</span> <span
class="id" type="var">X2</span>\
   | ?<span class="id" type="var">X1</span> ?<span class="id"
type="var">X2</span> ?<span class="id" type="var">X3</span> ⇒\
      <span class="id" type="var">go</span> <span class="id"
type="var">X1</span>; <span class="id" type="var">go</span> <span
class="id" type="var">X2</span>; <span class="id" type="var">go</span>
<span class="id" type="var">X3</span>\
   | ?<span class="id" type="var">X1</span> ?<span class="id"
type="var">X2</span> ?<span class="id" type="var">X3</span> ?<span
class="id" type="var">X4</span> ⇒\
      <span class="id" type="var">go</span> <span class="id"
type="var">X1</span>; <span class="id" type="var">go</span> <span
class="id" type="var">X2</span>; <span class="id" type="var">go</span>
<span class="id" type="var">X3</span>; <span class="id"
type="var">go</span> <span class="id" type="var">X4</span>\
   | ?<span class="id" type="var">X1</span> ?<span class="id"
type="var">X2</span> ?<span class="id" type="var">X3</span> ?<span
class="id" type="var">X4</span> ?<span class="id" type="var">X5</span>
⇒\
      <span class="id" type="var">go</span> <span class="id"
type="var">X1</span>; <span class="id" type="var">go</span> <span
class="id" type="var">X2</span>; <span class="id" type="var">go</span>
<span class="id" type="var">X3</span>; <span class="id"
type="var">go</span> <span class="id" type="var">X4</span>; <span
class="id" type="var">go</span> <span class="id" type="var">X5</span>\
   | ?<span class="id" type="var">X1</span> ?<span class="id"
type="var">X2</span> ?<span class="id" type="var">X3</span> ?<span
class="id" type="var">X4</span> ?<span class="id" type="var">X5</span>
?<span class="id" type="var">X6</span> ⇒\
      <span class="id" type="var">go</span> <span class="id"
type="var">X1</span>; <span class="id" type="var">go</span> <span
class="id" type="var">X2</span>; <span class="id" type="var">go</span>
<span class="id" type="var">X3</span>; <span class="id"
type="var">go</span> <span class="id" type="var">X4</span>; <span
class="id" type="var">go</span> <span class="id" type="var">X5</span>;
<span class="id" type="var">go</span> <span class="id"
type="var">X6</span>\
   | ?<span class="id" type="var">X1</span> ?<span class="id"
type="var">X2</span> ?<span class="id" type="var">X3</span> ?<span
class="id" type="var">X4</span> ?<span class="id" type="var">X5</span>
?<span class="id" type="var">X6</span> ?<span class="id"
type="var">X7</span> ⇒\
      <span class="id" type="var">go</span> <span class="id"
type="var">X1</span>; <span class="id" type="var">go</span> <span
class="id" type="var">X2</span>; <span class="id" type="var">go</span>
<span class="id" type="var">X3</span>; <span class="id"
type="var">go</span> <span class="id" type="var">X4</span>; <span
class="id" type="var">go</span> <span class="id" type="var">X5</span>;
<span class="id" type="var">go</span> <span class="id"
type="var">X6</span>; <span class="id" type="var">go</span> <span
class="id" type="var">X7</span>\
   | ?<span class="id" type="var">X1</span> ?<span class="id"
type="var">X2</span> ?<span class="id" type="var">X3</span> ?<span
class="id" type="var">X4</span> ?<span class="id" type="var">X5</span>
?<span class="id" type="var">X6</span> ?<span class="id"
type="var">X7</span> ?<span class="id" type="var">X8</span> ⇒\
      <span class="id" type="var">go</span> <span class="id"
type="var">X1</span>; <span class="id" type="var">go</span> <span
class="id" type="var">X2</span>; <span class="id" type="var">go</span>
<span class="id" type="var">X3</span>; <span class="id"
type="var">go</span> <span class="id" type="var">X4</span>; <span
class="id" type="var">go</span> <span class="id" type="var">X5</span>;
<span class="id" type="var">go</span> <span class="id"
type="var">X6</span>; <span class="id" type="var">go</span> <span
class="id" type="var">X7</span>; <span class="id" type="var">go</span>
<span class="id" type="var">X8</span>\
   | ?<span class="id" type="var">X1</span> ?<span class="id"
type="var">X2</span> ?<span class="id" type="var">X3</span> ?<span
class="id" type="var">X4</span> ?<span class="id" type="var">X5</span>
?<span class="id" type="var">X6</span> ?<span class="id"
type="var">X7</span> ?<span class="id" type="var">X8</span> ?<span
class="id" type="var">X9</span> ⇒\
      <span class="id" type="var">go</span> <span class="id"
type="var">X1</span>; <span class="id" type="var">go</span> <span
class="id" type="var">X2</span>; <span class="id" type="var">go</span>
<span class="id" type="var">X3</span>; <span class="id"
type="var">go</span> <span class="id" type="var">X4</span>; <span
class="id" type="var">go</span> <span class="id" type="var">X5</span>;
<span class="id" type="var">go</span> <span class="id"
type="var">X6</span>; <span class="id" type="var">go</span> <span
class="id" type="var">X7</span>; <span class="id" type="var">go</span>
<span class="id" type="var">X8</span>; <span class="id"
type="var">go</span> <span class="id" type="var">X9</span>\
   | ?<span class="id" type="var">X1</span> ?<span class="id"
type="var">X2</span> ?<span class="id" type="var">X3</span> ?<span
class="id" type="var">X4</span> ?<span class="id" type="var">X5</span>
?<span class="id" type="var">X6</span> ?<span class="id"
type="var">X7</span> ?<span class="id" type="var">X8</span> ?<span
class="id" type="var">X9</span> ?<span class="id" type="var">X10</span>
⇒\
      <span class="id" type="var">go</span> <span class="id"
type="var">X1</span>; <span class="id" type="var">go</span> <span
class="id" type="var">X2</span>; <span class="id" type="var">go</span>
<span class="id" type="var">X3</span>; <span class="id"
type="var">go</span> <span class="id" type="var">X4</span>; <span
class="id" type="var">go</span> <span class="id" type="var">X5</span>;
<span class="id" type="var">go</span> <span class="id"
type="var">X6</span>; <span class="id" type="var">go</span> <span
class="id" type="var">X7</span>; <span class="id" type="var">go</span>
<span class="id" type="var">X8</span>; <span class="id"
type="var">go</span> <span class="id" type="var">X9</span>; <span
class="id" type="var">go</span> <span class="id" type="var">X10</span>\
   | <span class="id" type="var">\_</span> ⇒ <span class="id"
type="var">idtac</span>\
   <span class="id" type="keyword">end</span>.\
\

</div>

<div class="doc">

For faster performance, one may deactivate <span
class="inlinecode"><span class="id" type="var">rm\_inside</span></span>
by replacing the body of this definition with <span
class="inlinecode"><span class="id" type="var">idtac</span></span>.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">fast\_rm\_inside</span> <span class="id" type="var">E</span>
:=\
   <span class="id" type="var">rm\_inside</span> <span class="id"
type="var">E</span>.\
\
 <span
class="comment">(\* ---------------------------------------------------------------------- \*)</span>\

</div>

<div class="doc">

Numbers as arguments {.section}
--------------------

<div class="paragraph">

</div>

When tactic takes a natural number as argument, it may be parsed either
as a natural number or as a relative number. In order for tactics to
convert their arguments into natural numbers, we provide a conversion
tactic.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Require</span> <span class="id"
type="var">BinPos</span> <span class="id"
type="var">Coq.ZArith.BinInt</span>.\
\
 <span class="id" type="keyword">Definition</span> <span class="id"
type="var">ltac\_nat\_from\_int</span> (<span class="id"
type="var">x</span>:<span class="id" type="var">BinInt.Z</span>) : <span
class="id" type="var">nat</span> :=\
   <span class="id" type="keyword">match</span> <span class="id"
type="var">x</span> <span class="id" type="keyword">with</span>\
   | <span class="id" type="var">BinInt.Z0</span> ⇒ 0%<span class="id"
type="var">nat</span>\
   | <span class="id" type="var">BinInt.Zpos</span> <span class="id"
type="var">p</span> ⇒ <span class="id"
type="var">BinPos.nat\_of\_P</span> <span class="id"
type="var">p</span>\
   | <span class="id" type="var">BinInt.Zneg</span> <span class="id"
type="var">p</span> ⇒ 0%<span class="id" type="var">nat</span>\
   <span class="id" type="keyword">end</span>.\
\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">nat\_from\_number</span> <span class="id" type="var">N</span>
:=\
   <span class="id" type="keyword">match</span> <span class="id"
type="var">type</span> <span class="id" type="var">of</span> <span
class="id" type="var">N</span> <span class="id"
type="keyword">with</span>\
   | <span class="id" type="var">nat</span> ⇒ <span class="id"
type="var">constr</span>:(<span class="id" type="var">N</span>)\
   | <span class="id" type="var">BinInt.Z</span> ⇒ <span class="id"
type="keyword">let</span> <span class="id" type="var">N'</span> := <span
class="id" type="var">constr</span>:(<span class="id"
type="var">ltac\_nat\_from\_int</span> <span class="id"
type="var">N</span>) <span class="id" type="keyword">in</span> <span
class="id" type="var">eval</span> <span class="id"
type="tactic">compute</span> <span class="id" type="keyword">in</span>
<span class="id" type="var">N'</span>\
   <span class="id" type="keyword">end</span>.\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id"
type="var">ltac\_pattern</span></span> <span class="inlinecode"><span
class="id" type="var">E</span></span> <span class="inlinecode"><span
class="id" type="tactic">at</span></span> <span class="inlinecode"><span
class="id" type="var">K</span></span> is the same as <span
class="inlinecode"><span class="id" type="tactic">pattern</span></span>
<span class="inlinecode"><span class="id" type="var">E</span></span>
<span class="inlinecode"><span class="id" type="tactic">at</span></span>
<span class="inlinecode"><span class="id" type="var">K</span></span>
except that <span class="inlinecode"><span class="id"
type="var">K</span></span> is a Coq natural rather than a Ltac integer.
Syntax <span class="inlinecode"><span class="id"
type="var">ltac\_pattern</span></span> <span class="inlinecode"><span
class="id" type="var">E</span></span> <span class="inlinecode"><span
class="id" type="keyword">as</span></span> <span
class="inlinecode"><span class="id" type="var">K</span></span> <span
class="inlinecode"><span class="id" type="keyword">in</span></span>
<span class="inlinecode"><span class="id" type="var">H</span></span> is
also available.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Tactic Notation</span> "ltac\_pattern"
<span class="id" type="var">constr</span>(<span class="id"
type="var">E</span>) "at" <span class="id"
type="var">constr</span>(<span class="id" type="var">K</span>) :=\
   <span class="id" type="keyword">match</span> <span class="id"
type="var">nat\_from\_number</span> <span class="id" type="var">K</span>
<span class="id" type="keyword">with</span>\
   | 1 ⇒ <span class="id" type="tactic">pattern</span> <span class="id"
type="var">E</span> <span class="id" type="tactic">at</span> 1\
   | 2 ⇒ <span class="id" type="tactic">pattern</span> <span class="id"
type="var">E</span> <span class="id" type="tactic">at</span> 2\
   | 3 ⇒ <span class="id" type="tactic">pattern</span> <span class="id"
type="var">E</span> <span class="id" type="tactic">at</span> 3\
   | 4 ⇒ <span class="id" type="tactic">pattern</span> <span class="id"
type="var">E</span> <span class="id" type="tactic">at</span> 4\
   | 5 ⇒ <span class="id" type="tactic">pattern</span> <span class="id"
type="var">E</span> <span class="id" type="tactic">at</span> 5\
   | 6 ⇒ <span class="id" type="tactic">pattern</span> <span class="id"
type="var">E</span> <span class="id" type="tactic">at</span> 6\
   | 7 ⇒ <span class="id" type="tactic">pattern</span> <span class="id"
type="var">E</span> <span class="id" type="tactic">at</span> 7\
   | 8 ⇒ <span class="id" type="tactic">pattern</span> <span class="id"
type="var">E</span> <span class="id" type="tactic">at</span> 8\
   <span class="id" type="keyword">end</span>.\
\
 <span class="id" type="keyword">Tactic Notation</span> "ltac\_pattern"
<span class="id" type="var">constr</span>(<span class="id"
type="var">E</span>) "at" <span class="id"
type="var">constr</span>(<span class="id" type="var">K</span>) "in"
<span class="id" type="var">hyp</span>(<span class="id"
type="var">H</span>) :=\
   <span class="id" type="keyword">match</span> <span class="id"
type="var">nat\_from\_number</span> <span class="id" type="var">K</span>
<span class="id" type="keyword">with</span>\
   | 1 ⇒ <span class="id" type="tactic">pattern</span> <span class="id"
type="var">E</span> <span class="id" type="tactic">at</span> 1 <span
class="id" type="keyword">in</span> <span class="id"
type="var">H</span>\
   | 2 ⇒ <span class="id" type="tactic">pattern</span> <span class="id"
type="var">E</span> <span class="id" type="tactic">at</span> 2 <span
class="id" type="keyword">in</span> <span class="id"
type="var">H</span>\
   | 3 ⇒ <span class="id" type="tactic">pattern</span> <span class="id"
type="var">E</span> <span class="id" type="tactic">at</span> 3 <span
class="id" type="keyword">in</span> <span class="id"
type="var">H</span>\
   | 4 ⇒ <span class="id" type="tactic">pattern</span> <span class="id"
type="var">E</span> <span class="id" type="tactic">at</span> 4 <span
class="id" type="keyword">in</span> <span class="id"
type="var">H</span>\
   | 5 ⇒ <span class="id" type="tactic">pattern</span> <span class="id"
type="var">E</span> <span class="id" type="tactic">at</span> 5 <span
class="id" type="keyword">in</span> <span class="id"
type="var">H</span>\
   | 6 ⇒ <span class="id" type="tactic">pattern</span> <span class="id"
type="var">E</span> <span class="id" type="tactic">at</span> 6 <span
class="id" type="keyword">in</span> <span class="id"
type="var">H</span>\
   | 7 ⇒ <span class="id" type="tactic">pattern</span> <span class="id"
type="var">E</span> <span class="id" type="tactic">at</span> 7 <span
class="id" type="keyword">in</span> <span class="id"
type="var">H</span>\
   | 8 ⇒ <span class="id" type="tactic">pattern</span> <span class="id"
type="var">E</span> <span class="id" type="tactic">at</span> 8 <span
class="id" type="keyword">in</span> <span class="id"
type="var">H</span>\
   <span class="id" type="keyword">end</span>.\
\
 <span
class="comment">(\* ---------------------------------------------------------------------- \*)</span>\

</div>

<div class="doc">

Testing tactics {.section}
---------------

<div class="paragraph">

</div>

<span class="inlinecode"><span class="id" type="var">show</span></span>
<span class="inlinecode"><span class="id" type="var">tac</span></span>
executes a tactic <span class="inlinecode"><span class="id"
type="var">tac</span></span> that produces a result, and then display
its result.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Tactic Notation</span> "show" <span
class="id" type="var">tactic</span>(<span class="id"
type="var">tac</span>) :=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">R</span> := <span class="id" type="var">tac</span> <span
class="id" type="keyword">in</span> <span class="id"
type="var">pose</span> <span class="id" type="var">R</span>.\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id" type="var">dup</span></span>
<span class="inlinecode"><span class="id" type="var">N</span></span>
produces <span class="inlinecode"><span class="id"
type="var">N</span></span> copies of the current goal. It is useful for
building examples on which to illustrate behaviour of tactics. <span
class="inlinecode"><span class="id" type="var">dup</span></span> is
short for <span class="inlinecode"><span class="id"
type="var">dup</span></span> <span class="inlinecode">2</span>.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Lemma</span> <span class="id"
type="var">dup\_lemma</span> : <span
style="font-family: arial;">∀</span><span class="id"
type="var">P</span>, <span class="id" type="var">P</span> <span
style="font-family: arial;">→</span> <span class="id"
type="var">P</span> <span style="font-family: arial;">→</span> <span
class="id" type="var">P</span>.\
 <span class="id" type="keyword">Proof</span>. <span class="id"
type="tactic">auto</span>. <span class="id" type="keyword">Qed</span>.\
\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">dup\_tactic</span> <span class="id" type="var">N</span> :=\
   <span class="id" type="keyword">match</span> <span class="id"
type="var">nat\_from\_number</span> <span class="id" type="var">N</span>
<span class="id" type="keyword">with</span>\
   | 0 ⇒ <span class="id" type="var">idtac</span>\
   | <span class="id" type="var">S</span> 0 ⇒ <span class="id"
type="var">idtac</span>\
   | <span class="id" type="var">S</span> ?<span class="id"
type="var">N'</span> ⇒ <span class="id" type="tactic">apply</span> <span
class="id" type="var">dup\_lemma</span>; [ | <span class="id"
type="var">dup\_tactic</span> <span class="id" type="var">N'</span> ]\
   <span class="id" type="keyword">end</span>.\
\
 <span class="id" type="keyword">Tactic Notation</span> "dup" <span
class="id" type="var">constr</span>(<span class="id"
type="var">N</span>) :=\
   <span class="id" type="var">dup\_tactic</span> <span class="id"
type="var">N</span>.\
 <span class="id" type="keyword">Tactic Notation</span> "dup" :=\
   <span class="id" type="var">dup</span> 2.\
\
 <span
class="comment">(\* ---------------------------------------------------------------------- \*)</span>\

</div>

<div class="doc">

Check no evar in goal {.section}
---------------------

</div>

<div class="code code-space">

\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">check\_noevar</span> <span class="id" type="var">M</span> :=\
   <span class="id" type="keyword">match</span> <span class="id"
type="var">M</span> <span class="id" type="keyword">with</span> <span
class="id" type="var">M</span> ⇒ <span class="id"
type="var">idtac</span> <span class="id" type="keyword">end</span>.\
\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">check\_noevar\_hyp</span> <span class="id"
type="var">H</span> := <span
class="comment">(\* todo: imlement using check\_noevar \*)</span>\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">T</span> := <span class="id" type="var">type</span> <span
class="id" type="var">of</span> <span class="id" type="var">H</span>
<span class="id" type="keyword">in</span>\
   <span class="id" type="keyword">match</span> <span class="id"
type="var">type</span> <span class="id" type="var">of</span> <span
class="id" type="var">H</span> <span class="id"
type="keyword">with</span> <span class="id" type="var">T</span> ⇒ <span
class="id" type="var">idtac</span> <span class="id"
type="keyword">end</span>.\
\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">check\_noevar\_goal</span> := <span
class="comment">(\* todo: imlement using check\_noevar \*)</span>\
   <span class="id" type="keyword">match</span> <span class="id"
type="var">goal</span> <span class="id" type="keyword">with</span> <span
style="font-family: arial;">⊢</span> ?<span class="id"
type="var">G</span> ⇒ <span class="id" type="keyword">match</span> <span
class="id" type="var">G</span> <span class="id"
type="keyword">with</span> <span class="id" type="var">G</span> ⇒ <span
class="id" type="var">idtac</span> <span class="id"
type="keyword">end</span> <span class="id" type="keyword">end</span>.\
\
 <span
class="comment">(\* ---------------------------------------------------------------------- \*)</span>\

</div>

<div class="doc">

Tagging of hypotheses {.section}
---------------------

<div class="paragraph">

</div>

<span class="inlinecode"><span class="id"
type="var">get\_last\_hyp</span></span> <span class="inlinecode"><span
class="id" type="var">tt</span></span> is a function that returns the
last hypothesis at the bottom of the context. It is useful to obtain the
default name associated with the hypothesis, e.g. <span
class="inlinecode"><span class="id" type="tactic">intro</span>;</span>
<span class="inlinecode"><span class="id"
type="keyword">let</span></span> <span class="inlinecode"><span
class="id" type="var">H</span></span> <span class="inlinecode">:=</span>
<span class="inlinecode"><span class="id"
type="var">get\_last\_hyp</span></span> <span class="inlinecode"><span
class="id" type="var">tt</span></span> <span class="inlinecode"><span
class="id" type="keyword">in</span></span> <span
class="inlinecode"><span class="id" type="keyword">let</span></span>
<span class="inlinecode"><span class="id" type="var">H'</span></span>
<span class="inlinecode">:=</span> <span class="inlinecode"><span
class="id" type="tactic">fresh</span></span> <span
class="inlinecode">"<span class="id" type="var">P</span>"</span> <span
class="inlinecode"><span class="id" type="var">H</span></span> <span
class="inlinecode"><span class="id" type="keyword">in</span></span>
<span class="inlinecode">...</span>

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">get\_last\_hyp</span> <span class="id" type="var">tt</span>
:=\
   <span class="id" type="keyword">match</span> <span class="id"
type="var">goal</span> <span class="id" type="keyword">with</span> <span
class="id" type="var">H</span>: <span class="id" type="var">\_</span>
<span style="font-family: arial;">⊢</span> <span class="id"
type="var">\_</span> ⇒ <span class="id" type="var">constr</span>:(<span
class="id" type="var">H</span>) <span class="id"
type="keyword">end</span>.\
\
 <span
class="comment">(\* ---------------------------------------------------------------------- \*)</span>\

</div>

<div class="doc">

Tagging of hypotheses {.section}
---------------------

<div class="paragraph">

</div>

<span class="inlinecode"><span class="id"
type="var">ltac\_tag\_subst</span></span> is a specific marker for
hypotheses which is used to tag hypotheses that are equalities to be
substituted.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Definition</span> <span class="id"
type="var">ltac\_tag\_subst</span> (<span class="id"
type="var">A</span>:<span class="id" type="keyword">Type</span>) (<span
class="id" type="var">x</span>:<span class="id" type="var">A</span>) :=
<span class="id" type="var">x</span>.\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id"
type="var">ltac\_to\_generalize</span></span> is a specific marker for
hypotheses to be generalized.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Definition</span> <span class="id"
type="var">ltac\_to\_generalize</span> (<span class="id"
type="var">A</span>:<span class="id" type="keyword">Type</span>) (<span
class="id" type="var">x</span>:<span class="id" type="var">A</span>) :=
<span class="id" type="var">x</span>.\
\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">gen\_to\_generalize</span> :=\
   <span class="id" type="tactic">repeat</span> <span class="id"
type="keyword">match</span> <span class="id" type="var">goal</span>
<span class="id" type="keyword">with</span>\
     <span class="id" type="var">H</span>: <span class="id"
type="var">ltac\_to\_generalize</span> <span class="id"
type="var">\_</span> <span style="font-family: arial;">⊢</span> <span
class="id" type="var">\_</span> ⇒ <span class="id"
type="tactic">generalize</span> <span class="id" type="var">H</span>;
<span class="id" type="tactic">clear</span> <span class="id"
type="var">H</span> <span class="id" type="keyword">end</span>.\
\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">mark\_to\_generalize</span> <span class="id"
type="var">H</span> :=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">T</span> := <span class="id" type="var">type</span> <span
class="id" type="var">of</span> <span class="id" type="var">H</span>
<span class="id" type="keyword">in</span>\
   <span class="id" type="var">change</span> <span class="id"
type="var">T</span> <span class="id" type="keyword">with</span> (<span
class="id" type="var">ltac\_to\_generalize</span> <span class="id"
type="var">T</span>) <span class="id" type="keyword">in</span> <span
class="id" type="var">H</span>.\
\
 <span
class="comment">(\* ---------------------------------------------------------------------- \*)</span>\

</div>

<div class="doc">

Deconstructing terms {.section}
--------------------

<div class="paragraph">

</div>

<span class="inlinecode"><span class="id"
type="var">get\_head</span></span> <span class="inlinecode"><span
class="id" type="var">E</span></span> is a tactic that returns the head
constant of the term <span class="inlinecode"><span class="id"
type="var">E</span></span>, ie, when applied to a term of the form <span
class="inlinecode"><span class="id" type="var">P</span></span> <span
class="inlinecode"><span class="id" type="var">x1</span></span> <span
class="inlinecode">...</span> <span class="inlinecode"><span class="id"
type="var">xN</span></span> it returns <span class="inlinecode"><span
class="id" type="var">P</span></span>. If <span class="inlinecode"><span
class="id" type="var">E</span></span> is not an application, it returns
<span class="inlinecode"><span class="id" type="var">E</span></span>.
Warning: the tactic seems to loop in some cases when the goal is a
product and one uses the result of this function.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">get\_head</span> <span class="id" type="var">E</span> :=\
   <span class="id" type="keyword">match</span> <span class="id"
type="var">E</span> <span class="id" type="keyword">with</span>\
   | ?<span class="id" type="var">P</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> ⇒ <span
class="id" type="var">constr</span>:(<span class="id"
type="var">P</span>)\
   | ?<span class="id" type="var">P</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> ⇒ <span class="id" type="var">constr</span>:(<span
class="id" type="var">P</span>)\
   | ?<span class="id" type="var">P</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> ⇒ <span class="id"
type="var">constr</span>:(<span class="id" type="var">P</span>)\
   | ?<span class="id" type="var">P</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span> ⇒
<span class="id" type="var">constr</span>:(<span class="id"
type="var">P</span>)\
   | ?<span class="id" type="var">P</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> ⇒ <span class="id"
type="var">constr</span>:(<span class="id" type="var">P</span>)\
   | ?<span class="id" type="var">P</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> ⇒ <span
class="id" type="var">constr</span>:(<span class="id"
type="var">P</span>)\
   | ?<span class="id" type="var">P</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> ⇒ <span class="id" type="var">constr</span>:(<span
class="id" type="var">P</span>)\
   | ?<span class="id" type="var">P</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> ⇒ <span class="id"
type="var">constr</span>:(<span class="id" type="var">P</span>)\
   | ?<span class="id" type="var">P</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span> ⇒
<span class="id" type="var">constr</span>:(<span class="id"
type="var">P</span>)\
   | ?<span class="id" type="var">P</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> ⇒ <span class="id"
type="var">constr</span>:(<span class="id" type="var">P</span>)\
   | ?<span class="id" type="var">P</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> ⇒ <span
class="id" type="var">constr</span>:(<span class="id"
type="var">P</span>)\
   | ?<span class="id" type="var">P</span> <span class="id"
type="var">\_</span> ⇒ <span class="id" type="var">constr</span>:(<span
class="id" type="var">P</span>)\
   | ?<span class="id" type="var">P</span> ⇒ <span class="id"
type="var">constr</span>:(<span class="id" type="var">P</span>)\
   <span class="id" type="keyword">end</span>.\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id"
type="var">get\_fun\_arg</span></span> <span class="inlinecode"><span
class="id" type="var">E</span></span> is a tactic that decomposes an
application term <span class="inlinecode"><span class="id"
type="var">E</span></span>, ie, when applied to a term of the form <span
class="inlinecode"><span class="id" type="var">X1</span></span> <span
class="inlinecode">...</span> <span class="inlinecode"><span class="id"
type="var">XN</span></span> it returns a pair made of <span
class="inlinecode"><span class="id" type="var">X1</span></span> <span
class="inlinecode">..</span> <span class="inlinecode"><span class="id"
type="var">X</span>(<span class="id" type="var">N</span>-1)</span> and
<span class="inlinecode"><span class="id" type="var">XN</span></span>.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">get\_fun\_arg</span> <span class="id" type="var">E</span> :=\
   <span class="id" type="keyword">match</span> <span class="id"
type="var">E</span> <span class="id" type="keyword">with</span>\
   | ?<span class="id" type="var">X1</span> ?<span class="id"
type="var">X2</span> ?<span class="id" type="var">X3</span> ?<span
class="id" type="var">X4</span> ?<span class="id" type="var">X5</span>
?<span class="id" type="var">X6</span> ?<span class="id"
type="var">X7</span> ?<span class="id" type="var">X</span> ⇒ <span
class="id" type="var">constr</span>:((<span class="id"
type="var">X1</span> <span class="id" type="var">X2</span> <span
class="id" type="var">X3</span> <span class="id" type="var">X4</span>
<span class="id" type="var">X5</span> <span class="id"
type="var">X6</span>,<span class="id" type="var">X</span>))\
   | ?<span class="id" type="var">X1</span> ?<span class="id"
type="var">X2</span> ?<span class="id" type="var">X3</span> ?<span
class="id" type="var">X4</span> ?<span class="id" type="var">X5</span>
?<span class="id" type="var">X6</span> ?<span class="id"
type="var">X</span> ⇒ <span class="id" type="var">constr</span>:((<span
class="id" type="var">X1</span> <span class="id" type="var">X2</span>
<span class="id" type="var">X3</span> <span class="id"
type="var">X4</span> <span class="id" type="var">X5</span>,<span
class="id" type="var">X</span>))\
   | ?<span class="id" type="var">X1</span> ?<span class="id"
type="var">X2</span> ?<span class="id" type="var">X3</span> ?<span
class="id" type="var">X4</span> ?<span class="id" type="var">X5</span>
?<span class="id" type="var">X</span> ⇒ <span class="id"
type="var">constr</span>:((<span class="id" type="var">X1</span> <span
class="id" type="var">X2</span> <span class="id" type="var">X3</span>
<span class="id" type="var">X4</span>,<span class="id"
type="var">X</span>))\
   | ?<span class="id" type="var">X1</span> ?<span class="id"
type="var">X2</span> ?<span class="id" type="var">X3</span> ?<span
class="id" type="var">X4</span> ?<span class="id" type="var">X</span> ⇒
<span class="id" type="var">constr</span>:((<span class="id"
type="var">X1</span> <span class="id" type="var">X2</span> <span
class="id" type="var">X3</span>,<span class="id" type="var">X</span>))\
   | ?<span class="id" type="var">X1</span> ?<span class="id"
type="var">X2</span> ?<span class="id" type="var">X3</span> ?<span
class="id" type="var">X</span> ⇒ <span class="id"
type="var">constr</span>:((<span class="id" type="var">X1</span> <span
class="id" type="var">X2</span>,<span class="id" type="var">X</span>))\
   | ?<span class="id" type="var">X1</span> ?<span class="id"
type="var">X2</span> ?<span class="id" type="var">X</span> ⇒ <span
class="id" type="var">constr</span>:((<span class="id"
type="var">X1</span>,<span class="id" type="var">X</span>))\
   | ?<span class="id" type="var">X1</span> ?<span class="id"
type="var">X</span> ⇒ <span class="id" type="var">constr</span>:((<span
class="id" type="var">X1</span>,<span class="id" type="var">X</span>))\
   <span class="id" type="keyword">end</span>.\
\
 <span
class="comment">(\* ---------------------------------------------------------------------- \*)</span>\

</div>

<div class="doc">

Action at occurence and action not at occurence {.section}
-----------------------------------------------

<div class="paragraph">

</div>

<span class="inlinecode"><span class="id"
type="var">ltac\_action\_at</span></span> <span class="inlinecode"><span
class="id" type="var">K</span></span> <span class="inlinecode"><span
class="id" type="var">of</span></span> <span class="inlinecode"><span
class="id" type="var">E</span></span> <span class="inlinecode"><span
class="id" type="tactic">do</span></span> <span class="inlinecode"><span
class="id" type="var">Tac</span></span> isolates the <span
class="inlinecode"><span class="id" type="var">K</span></span>-th
occurence of <span class="inlinecode"><span class="id"
type="var">E</span></span> in the goal, setting it in the form <span
class="inlinecode"><span class="id" type="var">P</span></span> <span
class="inlinecode"><span class="id" type="var">E</span></span> for some
named pattern <span class="inlinecode"><span class="id"
type="var">P</span></span>, then calls tactic <span
class="inlinecode"><span class="id" type="var">Tac</span></span>, and
finally unfolds <span class="inlinecode"><span class="id"
type="var">P</span></span>. Syntax <span class="inlinecode"><span
class="id" type="var">ltac\_action\_at</span></span> <span
class="inlinecode"><span class="id" type="var">K</span></span> <span
class="inlinecode"><span class="id" type="var">of</span></span> <span
class="inlinecode"><span class="id" type="var">E</span></span> <span
class="inlinecode"><span class="id" type="keyword">in</span></span>
<span class="inlinecode"><span class="id" type="var">H</span></span>
<span class="inlinecode"><span class="id" type="tactic">do</span></span>
<span class="inlinecode"><span class="id" type="var">Tac</span></span>
is also available.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Tactic Notation</span>
"ltac\_action\_at" <span class="id" type="var">constr</span>(<span
class="id" type="var">K</span>) "of" <span class="id"
type="var">constr</span>(<span class="id" type="var">E</span>) "do"
<span class="id" type="var">tactic</span>(<span class="id"
type="var">Tac</span>) :=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">p</span> := <span class="id" type="tactic">fresh</span> <span
class="id" type="keyword">in</span> <span class="id"
type="var">ltac\_pattern</span> <span class="id" type="var">E</span>
<span class="id" type="tactic">at</span> <span class="id"
type="var">K</span>;\
   <span class="id" type="keyword">match</span> <span class="id"
type="var">goal</span> <span class="id" type="keyword">with</span> <span
style="font-family: arial;">⊢</span> ?<span class="id"
type="var">P</span> <span class="id" type="var">\_</span> ⇒ <span
class="id" type="tactic">set</span> (<span class="id"
type="var">p</span>:=<span class="id" type="var">P</span>) <span
class="id" type="keyword">end</span>;\
   <span class="id" type="var">Tac</span>; <span class="id"
type="tactic">unfold</span> <span class="id" type="var">p</span>; <span
class="id" type="tactic">clear</span> <span class="id"
type="var">p</span>.\
\
 <span class="id" type="keyword">Tactic Notation</span>
"ltac\_action\_at" <span class="id" type="var">constr</span>(<span
class="id" type="var">K</span>) "of" <span class="id"
type="var">constr</span>(<span class="id" type="var">E</span>) "in"
<span class="id" type="var">hyp</span>(<span class="id"
type="var">H</span>) "do" <span class="id"
type="var">tactic</span>(<span class="id" type="var">Tac</span>) :=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">p</span> := <span class="id" type="tactic">fresh</span> <span
class="id" type="keyword">in</span> <span class="id"
type="var">ltac\_pattern</span> <span class="id" type="var">E</span>
<span class="id" type="tactic">at</span> <span class="id"
type="var">K</span> <span class="id" type="keyword">in</span> <span
class="id" type="var">H</span>;\
   <span class="id" type="keyword">match</span> <span class="id"
type="var">type</span> <span class="id" type="var">of</span> <span
class="id" type="var">H</span> <span class="id"
type="keyword">with</span> ?<span class="id" type="var">P</span> <span
class="id" type="var">\_</span> ⇒ <span class="id"
type="tactic">set</span> (<span class="id" type="var">p</span>:=<span
class="id" type="var">P</span>) <span class="id"
type="keyword">in</span> <span class="id" type="var">H</span> <span
class="id" type="keyword">end</span>;\
   <span class="id" type="var">Tac</span>; <span class="id"
type="tactic">unfold</span> <span class="id" type="var">p</span> <span
class="id" type="keyword">in</span> <span class="id"
type="var">H</span>; <span class="id" type="tactic">clear</span> <span
class="id" type="var">p</span>.\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id"
type="var">protects</span></span> <span class="inlinecode"><span
class="id" type="var">E</span></span> <span class="inlinecode"><span
class="id" type="tactic">do</span></span> <span class="inlinecode"><span
class="id" type="var">Tac</span></span> temporarily assigns a name to
the expression <span class="inlinecode"><span class="id"
type="var">E</span></span> so that the execution of tactic <span
class="inlinecode"><span class="id" type="var">Tac</span></span> will
not modify <span class="inlinecode"><span class="id"
type="var">E</span></span>. This is useful for instance to restrict the
action of <span class="inlinecode"><span class="id"
type="tactic">simpl</span></span>.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Tactic Notation</span> "protects" <span
class="id" type="var">constr</span>(<span class="id"
type="var">E</span>) "do" <span class="id"
type="var">tactic</span>(<span class="id" type="var">Tac</span>) :=\
   <span
class="comment">(\* let x := fresh "TEMP" in sets\_eq x: E; T; subst x. \*)</span>\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">x</span> := <span class="id" type="tactic">fresh</span>
"TEMP" <span class="id" type="keyword">in</span> <span class="id"
type="keyword">let</span> <span class="id" type="var">H</span> := <span
class="id" type="tactic">fresh</span> "TEMP" <span class="id"
type="keyword">in</span>\
   <span class="id" type="tactic">set</span> (<span class="id"
type="var">X</span> := <span class="id" type="var">E</span>) <span
class="id" type="keyword">in</span> ×; <span class="id"
type="tactic">assert</span> (<span class="id" type="var">H</span> :
<span class="id" type="var">X</span> = <span class="id"
type="var">E</span>) <span class="id" type="tactic">by</span> <span
class="id" type="tactic">reflexivity</span>;\
   <span class="id" type="var">clearbody</span> <span class="id"
type="var">X</span>; <span class="id" type="var">Tac</span>; <span
class="id" type="tactic">subst</span> <span class="id"
type="var">x</span>.\
\
 <span class="id" type="keyword">Tactic Notation</span> "protects" <span
class="id" type="var">constr</span>(<span class="id"
type="var">E</span>) "do" <span class="id"
type="var">tactic</span>(<span class="id" type="var">Tac</span>) "/" :=\
   <span class="id" type="var">protects</span> <span class="id"
type="var">E</span> <span class="id" type="tactic">do</span> <span
class="id" type="var">Tac</span>.\
\
 <span
class="comment">(\* ---------------------------------------------------------------------- \*)</span>\

</div>

<div class="doc">

An alias for <span class="inlinecode"><span class="id" type="var">eq</span></span> {.section}
----------------------------------------------------------------------------------

<div class="paragraph">

</div>

<span class="inlinecode"><span class="id" type="var">eq'</span></span>
is an alias for <span class="inlinecode"><span class="id"
type="var">eq</span></span> to be used for equalities in inductive
definitions, so that they don't get mixed with equalities generated by
<span class="inlinecode"><span class="id"
type="tactic">inversion</span></span>.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Definition</span> <span class="id"
type="var">eq'</span> := @<span class="id" type="var">eq</span>.\
\
 <span class="id" type="keyword">Hint</span> <span class="id"
type="keyword">Unfold</span> <span class="id" type="var">eq'</span>.\
\
 <span class="id" type="keyword">Notation</span> "x '='' y" := (@<span
class="id" type="var">eq'</span> <span class="id" type="var">\_</span>
<span class="id" type="var">x</span> <span class="id"
type="var">y</span>)\
   (<span class="id" type="tactic">at</span> <span class="id"
type="var">level</span> 70, <span class="id" type="var">arguments</span>
<span class="id" type="tactic">at</span> <span class="id"
type="var">next</span> <span class="id" type="var">level</span>).\
\
 <span
class="comment">(\* \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* \*)</span>\

</div>

<div class="doc">

Backward and forward chaining {.section}
=============================

</div>

<div class="code code-space">

\
 <span
class="comment">(\* ---------------------------------------------------------------------- \*)</span>\

</div>

<div class="doc">

Application {.section}
-----------

<div class="paragraph">

</div>

<span class="inlinecode"><span class="id"
type="var">rapply</span></span> is a tactic similar to <span
class="inlinecode"><span class="id" type="tactic">eapply</span></span>
except that it is based on the <span class="inlinecode"><span class="id"
type="tactic">refine</span></span> tactics, and thus is strictly more
powerful (at least in theory :). In short, it is able to perform
on-the-fly conversions when required for arguments to match, and it is
able to instantiate existentials when required.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Tactic Notation</span> "rapply" <span
class="id" type="var">constr</span>(<span class="id"
type="var">t</span>) :=\
   <span class="id" type="var">first</span> <span
class="comment">(\* todo: les @ sont inutiles \*)</span>\
   [ <span class="id" type="var">eexact</span> (@<span class="id"
type="var">t</span>)\
   | <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span>)\
   | <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span> <span class="id" type="var">\_</span>)\
   | <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span>)\
   | <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>)\
   | <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span>)\
   | <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span>)\
   | <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span>)\
   | <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span>)\
   | <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>)\
   | <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span>)\
   | <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span>)\
   | <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span>)\
   | <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span>)\
   | <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>)\
   | <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span>)\
   | <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span>)\
   ].\
\

</div>

<div class="doc">

The tactics <span class="inlinecode"><span class="id"
type="var">applys\_N</span></span> <span class="inlinecode"><span
class="id" type="var">T</span></span>, where <span
class="inlinecode"><span class="id" type="var">N</span></span> is a
natural number, provides a more efficient way of using <span
class="inlinecode"><span class="id" type="var">applys</span></span>
<span class="inlinecode"><span class="id" type="var">T</span></span>. It
avoids trying out all possible arities, by specifying explicitely the
arity of function <span class="inlinecode"><span class="id"
type="var">T</span></span>.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Tactic Notation</span> "rapply\_0"
<span class="id" type="var">constr</span>(<span class="id"
type="var">t</span>) :=\
   <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "rapply\_1"
<span class="id" type="var">constr</span>(<span class="id"
type="var">t</span>) :=\
   <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span> <span class="id" type="var">\_</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "rapply\_2"
<span class="id" type="var">constr</span>(<span class="id"
type="var">t</span>) :=\
   <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "rapply\_3"
<span class="id" type="var">constr</span>(<span class="id"
type="var">t</span>) :=\
   <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "rapply\_4"
<span class="id" type="var">constr</span>(<span class="id"
type="var">t</span>) :=\
   <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "rapply\_5"
<span class="id" type="var">constr</span>(<span class="id"
type="var">t</span>) :=\
   <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "rapply\_6"
<span class="id" type="var">constr</span>(<span class="id"
type="var">t</span>) :=\
   <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "rapply\_7"
<span class="id" type="var">constr</span>(<span class="id"
type="var">t</span>) :=\
   <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "rapply\_8"
<span class="id" type="var">constr</span>(<span class="id"
type="var">t</span>) :=\
   <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "rapply\_9"
<span class="id" type="var">constr</span>(<span class="id"
type="var">t</span>) :=\
   <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "rapply\_10"
<span class="id" type="var">constr</span>(<span class="id"
type="var">t</span>) :=\
   <span class="id" type="tactic">refine</span> (@<span class="id"
type="var">t</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span>).\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id"
type="var">lets\_base</span></span> <span class="inlinecode"><span
class="id" type="var">H</span></span> <span class="inlinecode"><span
class="id" type="var">E</span></span> adds an hypothesis <span
class="inlinecode"><span class="id" type="var">H</span></span> <span
class="inlinecode">:</span> <span class="inlinecode"><span class="id"
type="var">T</span></span> to the context, where <span
class="inlinecode"><span class="id" type="var">T</span></span> is the
type of term <span class="inlinecode"><span class="id"
type="var">E</span></span>. If <span class="inlinecode"><span class="id"
type="var">H</span></span> is an introduction pattern, it will destruct
<span class="inlinecode"><span class="id" type="var">H</span></span>
according to the pattern.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">lets\_base</span> <span class="id" type="var">I</span> <span
class="id" type="var">E</span> := <span class="id"
type="tactic">generalize</span> <span class="id" type="var">E</span>;
<span class="id" type="tactic">intros</span> <span class="id"
type="var">I</span>.\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id"
type="var">applys\_to</span></span> <span class="inlinecode"><span
class="id" type="var">H</span></span> <span class="inlinecode"><span
class="id" type="var">E</span></span> transform the type of hypothesis
<span class="inlinecode"><span class="id" type="var">H</span></span> by
replacing it by the result of the application of the term <span
class="inlinecode"><span class="id" type="var">E</span></span> to <span
class="inlinecode"><span class="id" type="var">H</span></span>.
Intuitively, it is equivalent to <span class="inlinecode"><span
class="id" type="var">lets</span></span> <span class="inlinecode"><span
class="id" type="var">H</span>:</span> <span class="inlinecode">(<span
class="id" type="var">E</span></span> <span class="inlinecode"><span
class="id" type="var">H</span>)</span>.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Tactic Notation</span> "applys\_to"
<span class="id" type="var">hyp</span>(<span class="id"
type="var">H</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">E</span>) :=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">H'</span> := <span class="id" type="tactic">fresh</span>
<span class="id" type="keyword">in</span> <span class="id"
type="tactic">rename</span> <span class="id" type="var">H</span> <span
class="id" type="var">into</span> <span class="id"
type="var">H'</span>;\
   (<span class="id" type="var">first</span> [ <span class="id"
type="var">lets\_base</span> <span class="id" type="var">H</span> (<span
class="id" type="var">E</span> <span class="id" type="var">H'</span>)\
          | <span class="id" type="var">lets\_base</span> <span
class="id" type="var">H</span> (<span class="id" type="var">E</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">H'</span>)\
          | <span class="id" type="var">lets\_base</span> <span
class="id" type="var">H</span> (<span class="id" type="var">E</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">H'</span>)\
          | <span class="id" type="var">lets\_base</span> <span
class="id" type="var">H</span> (<span class="id" type="var">E</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">H'</span>)\
          | <span class="id" type="var">lets\_base</span> <span
class="id" type="var">H</span> (<span class="id" type="var">E</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">H'</span>)\
          | <span class="id" type="var">lets\_base</span> <span
class="id" type="var">H</span> (<span class="id" type="var">E</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">H'</span>)\
          | <span class="id" type="var">lets\_base</span> <span
class="id" type="var">H</span> (<span class="id" type="var">E</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">H'</span>)\
          | <span class="id" type="var">lets\_base</span> <span
class="id" type="var">H</span> (<span class="id" type="var">E</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">H'</span>)\
          | <span class="id" type="var">lets\_base</span> <span
class="id" type="var">H</span> (<span class="id" type="var">E</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">H'</span>)\
          | <span class="id" type="var">lets\_base</span> <span
class="id" type="var">H</span> (<span class="id" type="var">E</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">\_</span>
<span class="id" type="var">\_</span> <span class="id"
type="var">\_</span> <span class="id" type="var">\_</span> <span
class="id" type="var">\_</span> <span class="id" type="var">H'</span>)
]\
   ); <span class="id" type="tactic">clear</span> <span class="id"
type="var">H'</span>.\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id"
type="var">constructors</span></span> calls <span
class="inlinecode"><span class="id" type="var">constructor</span></span>
or <span class="inlinecode"><span class="id"
type="var">econstructor</span></span>.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Tactic Notation</span> "constructors"
:=\
   <span class="id" type="var">first</span> [ <span class="id"
type="var">constructor</span> | <span class="id"
type="var">econstructor</span> ]; <span class="id"
type="tactic">unfold</span> <span class="id" type="var">eq'</span>.\
\
 <span
class="comment">(\* ---------------------------------------------------------------------- \*)</span>\

</div>

<div class="doc">

Assertions {.section}
----------

<div class="paragraph">

</div>

<span class="inlinecode"><span class="id"
type="var">false\_goal</span></span> replaces any goal by the goal <span
class="inlinecode"><span class="id" type="var">False</span></span>.
Contrary to the tactic <span class="inlinecode"><span class="id"
type="var">false</span></span> (below), it does not try to do anything
else

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Tactic Notation</span> "false\_goal"
:=\
   <span class="id" type="tactic">elimtype</span> <span class="id"
type="var">False</span>.\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id"
type="var">false\_post</span></span> is the underlying tactic used to
prove goals of the form <span class="inlinecode"><span class="id"
type="var">False</span></span>. In the default implementation, it proves
the goal if the context contains <span class="inlinecode"><span
class="id" type="var">False</span></span> or an hypothesis of the form
<span class="inlinecode"><span class="id" type="var">C</span></span>
<span class="inlinecode"><span class="id" type="var">x1</span></span>
<span class="inlinecode">..</span> <span class="inlinecode"><span
class="id" type="var">xN</span></span> <span class="inlinecode">=</span>
<span class="inlinecode"><span class="id" type="var">D</span></span>
<span class="inlinecode"><span class="id" type="var">y1</span></span>
<span class="inlinecode">..</span> <span class="inlinecode"><span
class="id" type="var">yM</span></span>, or if the <span
class="inlinecode"><span class="id"
type="tactic">congruence</span></span> tactic finds a proof of <span
class="inlinecode"><span class="id" type="var">x</span></span> <span
class="inlinecode">≠</span> <span class="inlinecode"><span class="id"
type="var">x</span></span> for some <span class="inlinecode"><span
class="id" type="var">x</span></span>.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">false\_post</span> :=\
   <span class="id" type="var">solve</span> [ <span class="id"
type="tactic">assumption</span> | <span class="id"
type="tactic">discriminate</span> | <span class="id"
type="tactic">congruence</span> ].\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id" type="var">false</span></span>
replaces any goal by the goal <span class="inlinecode"><span class="id"
type="var">False</span></span>, and calls <span class="inlinecode"><span
class="id" type="var">false\_post</span></span>

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Tactic Notation</span> "false" :=\
   <span class="id" type="var">false\_goal</span>; <span class="id"
type="tactic">try</span> <span class="id"
type="var">false\_post</span>.\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id"
type="var">tryfalse</span></span> tries to solve a goal by
contradiction, and leaves the goal unchanged if it cannot solve it. It
is equivalent to <span class="inlinecode"><span class="id"
type="tactic">try</span></span> <span class="inlinecode"><span
class="id" type="var">solve</span></span> <span
class="inlinecode">\\[</span> <span class="inlinecode"><span class="id"
type="var">false</span></span> <span class="inlinecode">\\]</span>.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Tactic Notation</span> "tryfalse" :=\
   <span class="id" type="tactic">try</span> <span class="id"
type="var">solve</span> [ <span class="id" type="var">false</span> ].\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id"
type="var">tryfalse</span></span> <span class="inlinecode"><span
class="id" type="tactic">by</span></span> <span class="inlinecode"><span
class="id" type="var">tac</span></span> <span
class="inlinecode">/</span> is that same as <span
class="inlinecode"><span class="id" type="var">tryfalse</span></span>
except that it tries to solve the goal using tactic <span
class="inlinecode"><span class="id" type="var">tac</span></span> if
<span class="inlinecode"><span class="id"
type="tactic">assumption</span></span> and <span
class="inlinecode"><span class="id"
type="tactic">discriminate</span></span> do not apply. It is equivalent
to <span class="inlinecode"><span class="id"
type="tactic">try</span></span> <span class="inlinecode"><span
class="id" type="var">solve</span></span> <span
class="inlinecode">\\[</span> <span class="inlinecode"><span class="id"
type="var">false</span>;</span> <span class="inlinecode"><span
class="id" type="var">tac</span></span> <span
class="inlinecode">\\]</span>. Example: <span class="inlinecode"><span
class="id" type="var">tryfalse</span></span> <span
class="inlinecode"><span class="id" type="tactic">by</span></span> <span
class="inlinecode"><span class="id"
type="tactic">congruence</span>/</span>

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Tactic Notation</span> "tryfalse" "by"
<span class="id" type="var">tactic</span>(<span class="id"
type="var">tac</span>) "/" :=\
   <span class="id" type="tactic">try</span> <span class="id"
type="var">solve</span> [ <span class="id" type="var">false</span>;
<span class="id" type="var">instantiate</span>; <span class="id"
type="var">tac</span> ].\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id" type="var">false</span></span>
<span class="inlinecode"><span class="id" type="var">T</span></span>
tries <span class="inlinecode"><span class="id"
type="var">false</span>;</span> <span class="inlinecode"><span
class="id" type="tactic">apply</span></span> <span
class="inlinecode"><span class="id" type="var">T</span></span>, or
otherwise adds <span class="inlinecode"><span class="id"
type="var">T</span></span> as an assumption and calls <span
class="inlinecode"><span class="id" type="var">false</span></span>.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Tactic Notation</span> "false" <span
class="id" type="var">constr</span>(<span class="id"
type="var">T</span>) "by" <span class="id"
type="var">tactic</span>(<span class="id" type="var">tac</span>) "/" :=\
   <span class="id" type="var">false\_goal</span>; <span class="id"
type="var">first</span>\
     [ <span class="id" type="var">first</span> [ <span class="id"
type="tactic">apply</span> <span class="id" type="var">T</span> | <span
class="id" type="tactic">eapply</span> <span class="id"
type="var">T</span> | <span class="id" type="var">rapply</span> <span
class="id" type="var">T</span>]; <span class="id"
type="var">instantiate</span>; <span class="id" type="var">tac</span>
<span class="comment">(\* todo: sapply?\*)</span>\
     | <span class="id" type="keyword">let</span> <span class="id"
type="var">H</span> := <span class="id" type="tactic">fresh</span> <span
class="id" type="keyword">in</span> <span class="id"
type="var">lets\_base</span> <span class="id" type="var">H</span> <span
class="id" type="var">T</span>;\
       <span class="id" type="var">first</span> [ <span class="id"
type="tactic">discriminate</span> <span class="id" type="var">H</span>
<span class="comment">(\* optimization \*)</span>\
             | <span class="id" type="var">false</span>; <span
class="id" type="var">instantiate</span>; <span class="id"
type="var">tac</span> ] ].\
    <span class="comment">(\* todo: false (\>\> H X1 X2)... \*)</span>\
\
 <span class="id" type="keyword">Tactic Notation</span> "false" <span
class="id" type="var">constr</span>(<span class="id"
type="var">T</span>) :=\
   <span class="id" type="var">false</span> <span class="id"
type="var">T</span> <span class="id" type="tactic">by</span> <span
class="id" type="var">idtac</span>/.\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id"
type="var">false\_invert</span></span> proves any goal provided there is
at least one hypothesis <span class="inlinecode"><span class="id"
type="var">H</span></span> in the context that can be proved absurd by
calling <span class="inlinecode"><span class="id"
type="tactic">inversion</span></span> <span class="inlinecode"><span
class="id" type="var">H</span></span>.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">false\_invert\_tactic</span> :=\
   <span class="id" type="keyword">match</span> <span class="id"
type="var">goal</span> <span class="id" type="keyword">with</span> <span
class="id" type="var">H</span>:\_ <span
style="font-family: arial;">⊢</span> <span class="id"
type="var">\_</span> ⇒\
     <span class="id" type="var">solve</span> [ <span class="id"
type="tactic">inversion</span> <span class="id" type="var">H</span>\
           | <span class="id" type="tactic">clear</span> <span
class="id" type="var">H</span>; <span class="id"
type="var">false\_invert\_tactic</span>\
           | <span class="id" type="tactic">fail</span> 2 ] <span
class="id" type="keyword">end</span>.\
\
 <span class="id" type="keyword">Tactic Notation</span> "false\_invert"
:=\
   <span class="id" type="var">false\_invert\_tactic</span>.\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id"
type="var">tryfalse\_invert</span></span> tries to prove the goal using
<span class="inlinecode"><span class="id" type="var">false</span></span>
or <span class="inlinecode"><span class="id"
type="var">false\_invert</span></span>, and leaves the goal unchanged if
it does not succeed.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Tactic Notation</span>
"tryfalse\_invert" :=\
   <span class="id" type="tactic">try</span> <span class="id"
type="var">solve</span> [ <span class="id" type="var">false</span> |
<span class="id" type="var">false\_invert</span> ].\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id"
type="var">asserts</span></span> <span class="inlinecode"><span
class="id" type="var">H</span>:</span> <span class="inlinecode"><span
class="id" type="var">T</span></span> is another syntax for <span
class="inlinecode"><span class="id" type="tactic">assert</span></span>
<span class="inlinecode">(<span class="id" type="var">H</span></span>
<span class="inlinecode">:</span> <span class="inlinecode"><span
class="id" type="var">T</span>)</span>, which also works with
introduction patterns. For instance, one can write: <span
class="inlinecode"><span class="id" type="var">asserts</span></span>
<span class="inlinecode">\\[<span class="id" type="var">x</span></span>
<span class="inlinecode"><span class="id" type="var">P</span>\\]</span>
<span class="inlinecode">(<span
style="font-family: arial;">∃</span></span> <span
class="inlinecode"><span class="id" type="var">n</span>,</span> <span
class="inlinecode"><span class="id" type="var">n</span></span> <span
class="inlinecode">=</span> <span class="inlinecode">3)</span>, or <span
class="inlinecode"><span class="id" type="var">asserts</span></span>
<span class="inlinecode">\\[<span class="id" type="var">H</span>|<span
class="id" type="var">H</span>\\]</span> <span class="inlinecode">(<span
class="id" type="var">n</span></span> <span class="inlinecode">=</span>
<span class="inlinecode">0</span> <span class="inlinecode"><span
style="font-family: arial;">∨</span></span> <span
class="inlinecode"><span class="id" type="var">n</span></span> <span
class="inlinecode">=</span> <span class="inlinecode">1).</span> <span
class="inlinecode"></span>

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Tactic Notation</span> "asserts" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I</span>) ":" <span class="id" type="var">constr</span>(<span
class="id" type="var">T</span>) :=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">H</span> := <span class="id" type="tactic">fresh</span> <span
class="id" type="keyword">in</span> <span class="id"
type="tactic">assert</span> (<span class="id" type="var">H</span> :
<span class="id" type="var">T</span>);\
   [ | <span class="id" type="tactic">generalize</span> <span class="id"
type="var">H</span>; <span class="id" type="tactic">clear</span> <span
class="id" type="var">H</span>; <span class="id"
type="tactic">intros</span> <span class="id" type="var">I</span> ].\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id"
type="var">asserts</span></span> <span class="inlinecode"><span
class="id" type="var">H1</span></span> <span
class="inlinecode">..</span> <span class="inlinecode"><span class="id"
type="var">HN</span>:</span> <span class="inlinecode"><span class="id"
type="var">T</span></span> is a shorthand for <span
class="inlinecode"><span class="id" type="var">asserts</span></span>
<span class="inlinecode">\\[<span class="id" type="var">H1</span></span>
<span class="inlinecode">\\[<span class="id" type="var">H2</span></span>
<span class="inlinecode">\\[..</span> <span class="inlinecode"><span
class="id" type="var">HN</span>\\]\\]\\]\\</span>: T].

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Tactic Notation</span> "asserts" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I1</span>)\
  <span class="id" type="var">simple\_intropattern</span>(<span
class="id" type="var">I2</span>) ":" <span class="id"
type="var">constr</span>(<span class="id" type="var">T</span>) :=\
   <span class="id" type="var">asserts</span> [<span class="id"
type="var">I1</span> <span class="id" type="var">I2</span>]: <span
class="id" type="var">T</span>.\
 <span class="id" type="keyword">Tactic Notation</span> "asserts" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I1</span>)\
  <span class="id" type="var">simple\_intropattern</span>(<span
class="id" type="var">I2</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I3</span>) ":" <span class="id"
type="var">constr</span>(<span class="id" type="var">T</span>) :=\
   <span class="id" type="var">asserts</span> [<span class="id"
type="var">I1</span> [<span class="id" type="var">I2</span> <span
class="id" type="var">I3</span>]]: <span class="id"
type="var">T</span>.\
 <span class="id" type="keyword">Tactic Notation</span> "asserts" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I1</span>)\
  <span class="id" type="var">simple\_intropattern</span>(<span
class="id" type="var">I2</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I3</span>)\
  <span class="id" type="var">simple\_intropattern</span>(<span
class="id" type="var">I4</span>) ":" <span class="id"
type="var">constr</span>(<span class="id" type="var">T</span>) :=\
   <span class="id" type="var">asserts</span> [<span class="id"
type="var">I1</span> [<span class="id" type="var">I2</span> [<span
class="id" type="var">I3</span> <span class="id"
type="var">I4</span>]]]: <span class="id" type="var">T</span>.\
 <span class="id" type="keyword">Tactic Notation</span> "asserts" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I1</span>)\
  <span class="id" type="var">simple\_intropattern</span>(<span
class="id" type="var">I2</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I3</span>)\
  <span class="id" type="var">simple\_intropattern</span>(<span
class="id" type="var">I4</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I5</span>) ":" <span class="id"
type="var">constr</span>(<span class="id" type="var">T</span>) :=\
   <span class="id" type="var">asserts</span> [<span class="id"
type="var">I1</span> [<span class="id" type="var">I2</span> [<span
class="id" type="var">I3</span> [<span class="id" type="var">I4</span>
<span class="id" type="var">I5</span>]]]]: <span class="id"
type="var">T</span>.\
 <span class="id" type="keyword">Tactic Notation</span> "asserts" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I1</span>)\
  <span class="id" type="var">simple\_intropattern</span>(<span
class="id" type="var">I2</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I3</span>)\
  <span class="id" type="var">simple\_intropattern</span>(<span
class="id" type="var">I4</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I5</span>)\
  <span class="id" type="var">simple\_intropattern</span>(<span
class="id" type="var">I6</span>) ":" <span class="id"
type="var">constr</span>(<span class="id" type="var">T</span>) :=\
   <span class="id" type="var">asserts</span> [<span class="id"
type="var">I1</span> [<span class="id" type="var">I2</span> [<span
class="id" type="var">I3</span> [<span class="id" type="var">I4</span>
[<span class="id" type="var">I5</span> <span class="id"
type="var">I6</span>]]]]]: <span class="id" type="var">T</span>.\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id"
type="var">asserts</span>:</span> <span class="inlinecode"><span
class="id" type="var">T</span></span> is <span class="inlinecode"><span
class="id" type="var">asserts</span></span> <span
class="inlinecode"><span class="id" type="var">H</span>:</span> <span
class="inlinecode"><span class="id" type="var">T</span></span> with
<span class="inlinecode"><span class="id" type="var">H</span></span>
being chosen automatically.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Tactic Notation</span> "asserts" ":"
<span class="id" type="var">constr</span>(<span class="id"
type="var">T</span>) :=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">H</span> := <span class="id" type="tactic">fresh</span> <span
class="id" type="keyword">in</span> <span class="id"
type="var">asserts</span> <span class="id" type="var">H</span> : <span
class="id" type="var">T</span>.\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id" type="var">cuts</span></span>
<span class="inlinecode"><span class="id" type="var">H</span>:</span>
<span class="inlinecode"><span class="id" type="var">T</span></span> is
the same as <span class="inlinecode"><span class="id"
type="var">asserts</span></span> <span class="inlinecode"><span
class="id" type="var">H</span>:</span> <span class="inlinecode"><span
class="id" type="var">T</span></span> except that the two subgoals
generated are swapped: the subgoal <span class="inlinecode"><span
class="id" type="var">T</span></span> comes second. Note that contrary
to <span class="inlinecode"><span class="id"
type="tactic">cut</span></span>, it introduces the hypothesis.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Tactic Notation</span> "cuts" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I</span>) ":" <span class="id" type="var">constr</span>(<span
class="id" type="var">T</span>) :=\
   <span class="id" type="tactic">cut</span> (<span class="id"
type="var">T</span>); [ <span class="id" type="tactic">intros</span>
<span class="id" type="var">I</span> | <span class="id"
type="var">idtac</span> ].\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id" type="var">cuts</span>:</span>
<span class="inlinecode"><span class="id" type="var">T</span></span> is
<span class="inlinecode"><span class="id" type="var">cuts</span></span>
<span class="inlinecode"><span class="id" type="var">H</span>:</span>
<span class="inlinecode"><span class="id" type="var">T</span></span>
with <span class="inlinecode"><span class="id"
type="var">H</span></span> being chosen automatically.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Tactic Notation</span> "cuts" ":" <span
class="id" type="var">constr</span>(<span class="id"
type="var">T</span>) :=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">H</span> := <span class="id" type="tactic">fresh</span> <span
class="id" type="keyword">in</span> <span class="id"
type="var">cuts</span> <span class="id" type="var">H</span>: <span
class="id" type="var">T</span>.\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id" type="var">cuts</span></span>
<span class="inlinecode"><span class="id" type="var">H1</span></span>
<span class="inlinecode">..</span> <span class="inlinecode"><span
class="id" type="var">HN</span>:</span> <span class="inlinecode"><span
class="id" type="var">T</span></span> is a shorthand for <span
class="inlinecode"><span class="id" type="var">cuts</span></span> <span
class="inlinecode">\\[<span class="id" type="var">H1</span></span> <span
class="inlinecode">\\[<span class="id" type="var">H2</span></span> <span
class="inlinecode">\\[..</span> <span class="inlinecode"><span
class="id" type="var">HN</span>\\]\\]\\]\\</span>: T].

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Tactic Notation</span> "cuts" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I1</span>)\
  <span class="id" type="var">simple\_intropattern</span>(<span
class="id" type="var">I2</span>) ":" <span class="id"
type="var">constr</span>(<span class="id" type="var">T</span>) :=\
   <span class="id" type="var">cuts</span> [<span class="id"
type="var">I1</span> <span class="id" type="var">I2</span>]: <span
class="id" type="var">T</span>.\
 <span class="id" type="keyword">Tactic Notation</span> "cuts" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I1</span>)\
  <span class="id" type="var">simple\_intropattern</span>(<span
class="id" type="var">I2</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I3</span>) ":" <span class="id"
type="var">constr</span>(<span class="id" type="var">T</span>) :=\
   <span class="id" type="var">cuts</span> [<span class="id"
type="var">I1</span> [<span class="id" type="var">I2</span> <span
class="id" type="var">I3</span>]]: <span class="id"
type="var">T</span>.\
 <span class="id" type="keyword">Tactic Notation</span> "cuts" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I1</span>)\
  <span class="id" type="var">simple\_intropattern</span>(<span
class="id" type="var">I2</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I3</span>)\
  <span class="id" type="var">simple\_intropattern</span>(<span
class="id" type="var">I4</span>) ":" <span class="id"
type="var">constr</span>(<span class="id" type="var">T</span>) :=\
   <span class="id" type="var">cuts</span> [<span class="id"
type="var">I1</span> [<span class="id" type="var">I2</span> [<span
class="id" type="var">I3</span> <span class="id"
type="var">I4</span>]]]: <span class="id" type="var">T</span>.\
 <span class="id" type="keyword">Tactic Notation</span> "cuts" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I1</span>)\
  <span class="id" type="var">simple\_intropattern</span>(<span
class="id" type="var">I2</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I3</span>)\
  <span class="id" type="var">simple\_intropattern</span>(<span
class="id" type="var">I4</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I5</span>) ":" <span class="id"
type="var">constr</span>(<span class="id" type="var">T</span>) :=\
   <span class="id" type="var">cuts</span> [<span class="id"
type="var">I1</span> [<span class="id" type="var">I2</span> [<span
class="id" type="var">I3</span> [<span class="id" type="var">I4</span>
<span class="id" type="var">I5</span>]]]]: <span class="id"
type="var">T</span>.\
 <span class="id" type="keyword">Tactic Notation</span> "cuts" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I1</span>)\
  <span class="id" type="var">simple\_intropattern</span>(<span
class="id" type="var">I2</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I3</span>)\
  <span class="id" type="var">simple\_intropattern</span>(<span
class="id" type="var">I4</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I5</span>)\
  <span class="id" type="var">simple\_intropattern</span>(<span
class="id" type="var">I6</span>) ":" <span class="id"
type="var">constr</span>(<span class="id" type="var">T</span>) :=\
   <span class="id" type="var">cuts</span> [<span class="id"
type="var">I1</span> [<span class="id" type="var">I2</span> [<span
class="id" type="var">I3</span> [<span class="id" type="var">I4</span>
[<span class="id" type="var">I5</span> <span class="id"
type="var">I6</span>]]]]]: <span class="id" type="var">T</span>.\
\
 <span
class="comment">(\* ---------------------------------------------------------------------- \*)</span>\

</div>

<div class="doc">

Instantiation and forward-chaining {.section}
----------------------------------

<div class="paragraph">

</div>

The instantiation tactics are used to instantiate a lemma <span
class="inlinecode"><span class="id" type="var">E</span></span> (whose
type is a product) on some arguments. The type of <span
class="inlinecode"><span class="id" type="var">E</span></span> is made
of implications and universal quantifications, e.g. <span
class="inlinecode"><span style="font-family: arial;">∀</span></span>
<span class="inlinecode"><span class="id" type="var">x</span>,</span>
<span class="inlinecode"><span class="id" type="var">P</span></span>
<span class="inlinecode"><span class="id" type="var">x</span></span>
<span class="inlinecode"><span
style="font-family: arial;">→</span></span> <span
class="inlinecode"><span style="font-family: arial;">∀</span></span>
<span class="inlinecode"><span class="id" type="var">y</span></span>
<span class="inlinecode"><span class="id" type="var">z</span>,</span>
<span class="inlinecode"><span class="id" type="var">Q</span></span>
<span class="inlinecode"><span class="id" type="var">x</span></span>
<span class="inlinecode"><span class="id" type="var">y</span></span>
<span class="inlinecode"><span class="id" type="var">z</span></span>
<span class="inlinecode"><span
style="font-family: arial;">→</span></span> <span
class="inlinecode"><span class="id" type="var">R</span></span> <span
class="inlinecode"><span class="id" type="var">z</span></span>.
<div class="paragraph">

</div>

The first possibility is to provide arguments in order: first <span
class="inlinecode"><span class="id" type="var">x</span></span>, then a
proof of <span class="inlinecode"><span class="id"
type="var">P</span></span> <span class="inlinecode"><span class="id"
type="var">x</span></span>, then <span class="inlinecode"><span
class="id" type="var">y</span></span> etc... In this mode, called
"Args", all the arguments are to be provided. If a wildcard is provided
(written <span class="inlinecode"><span class="id"
type="var">\_\_</span></span>), then an existential variable will be
introduced in place of the argument.
<div class="paragraph">

</div>

It often saves a lot of time to give only the dependent variables, (here
<span class="inlinecode"><span class="id" type="var">x</span></span>,
<span class="inlinecode"><span class="id" type="var">y</span></span> and
<span class="inlinecode"><span class="id" type="var">z</span></span>),
and have the hypotheses generated as subgoals. In this "Vars" mode, only
variables are to be provided. For instance, lemma <span
class="inlinecode"><span class="id" type="var">E</span></span> applied
to <span class="inlinecode">3</span> and <span
class="inlinecode">4</span> is a term of type <span
class="inlinecode"><span style="font-family: arial;">∀</span></span>
<span class="inlinecode"><span class="id" type="var">z</span>,</span>
<span class="inlinecode"><span class="id" type="var">Q</span></span>
<span class="inlinecode">3</span> <span class="inlinecode">4</span>
<span class="inlinecode"><span class="id" type="var">z</span></span>
<span class="inlinecode"><span
style="font-family: arial;">→</span></span> <span
class="inlinecode"><span class="id" type="var">R</span></span> <span
class="inlinecode"><span class="id" type="var">z</span></span>, and
<span class="inlinecode"><span class="id" type="var">P</span></span>
<span class="inlinecode">3</span> is a new subgoal. It is possible to
use wildcards to introduce existential variables.
<div class="paragraph">

</div>

However, there are situations where some of the hypotheses already
exists, and it saves time to instantiate the lemma <span
class="inlinecode"><span class="id" type="var">E</span></span> using the
hypotheses. For instance, suppose <span class="inlinecode"><span
class="id" type="var">F</span></span> is a term of type <span
class="inlinecode"><span class="id" type="var">P</span></span> <span
class="inlinecode">2</span>. Then the application of <span
class="inlinecode"><span class="id" type="var">E</span></span> to <span
class="inlinecode"><span class="id" type="var">F</span></span> in this
"Hyps" mode is a term of type <span class="inlinecode"><span
style="font-family: arial;">∀</span></span> <span
class="inlinecode"><span class="id" type="var">y</span></span> <span
class="inlinecode"><span class="id" type="var">z</span>,</span> <span
class="inlinecode"><span class="id" type="var">Q</span></span> <span
class="inlinecode">2</span> <span class="inlinecode"><span class="id"
type="var">y</span></span> <span class="inlinecode"><span class="id"
type="var">z</span></span> <span class="inlinecode"><span
style="font-family: arial;">→</span></span> <span
class="inlinecode"><span class="id" type="var">R</span></span> <span
class="inlinecode"><span class="id" type="var">z</span></span>. Each
wildcard use will generate an assertion instead, for instance if <span
class="inlinecode"><span class="id" type="var">G</span></span> has type
<span class="inlinecode"><span class="id" type="var">Q</span></span>
<span class="inlinecode">2</span> <span class="inlinecode">3</span>
<span class="inlinecode">4</span>, then the application of <span
class="inlinecode"><span class="id" type="var">E</span></span> to a
wildcard and to <span class="inlinecode"><span class="id"
type="var">G</span></span> in mode-h is a term of type <span
class="inlinecode"><span class="id" type="var">R</span></span> <span
class="inlinecode">4</span>, and <span class="inlinecode"><span
class="id" type="var">P</span></span> <span class="inlinecode">2</span>
is a new subgoal.
<div class="paragraph">

</div>

It is very convenient to give some arguments the lemma should be
instantiated on, and let the tactic find out automatically where
underscores should be insterted. Underscore arguments <span
class="inlinecode"><span class="id" type="var">\_\_</span></span> are
interpret as follows: an underscore means that we want to skip the
argument that has the same type as the next real argument provided (real
means not an underscore). If there is no real argument after underscore,
then the underscore is used for the first possible argument.
<div class="paragraph">

</div>

The general syntax is <span class="inlinecode"><span class="id"
type="var">tactic</span></span> <span class="inlinecode">(\>\></span>
<span class="inlinecode"><span class="id" type="var">E1</span></span>
<span class="inlinecode">..</span> <span class="inlinecode"><span
class="id" type="var">EN</span>)</span> where <span
class="inlinecode"><span class="id" type="var">tactic</span></span> is
the name of the tactic (possibly with some arguments) and <span
class="inlinecode"><span class="id" type="var">Ei</span></span> are the
arguments. Moreover, some tactics accept the syntax <span
class="inlinecode"><span class="id" type="var">tactic</span></span>
<span class="inlinecode"><span class="id" type="var">E1</span></span>
<span class="inlinecode">..</span> <span class="inlinecode"><span
class="id" type="var">EN</span></span> as short for <span
class="inlinecode"><span class="id" type="var">tactic</span></span>
<span class="inlinecode">(\>\><span class="id"
type="var">Hnts</span></span> <span class="inlinecode"><span class="id"
type="var">E1</span></span> <span class="inlinecode">..</span> <span
class="inlinecode"><span class="id" type="var">EN</span>)</span> for
values of <span class="inlinecode"><span class="id"
type="var">N</span></span> up to 5.
<div class="paragraph">

</div>

Finally, if the argument <span class="inlinecode"><span class="id"
type="var">EN</span></span> given is a triple-underscore <span
class="inlinecode"><span class="id" type="var">\_\_\_</span></span>,
then it is equivalent to providing a list of wildcards, with the
appropriate number of wildcards. This means that all the remaining
arguments of the lemma will be instantiated.

</div>

<div class="code code-tight">

\
 <span class="comment">(\* Underlying implementation \*)</span>\
\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">app\_assert</span> <span class="id" type="var">t</span> <span
class="id" type="var">P</span> <span class="id" type="var">cont</span>
:=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">H</span> := <span class="id" type="tactic">fresh</span>
"TEMP" <span class="id" type="keyword">in</span>\
   <span class="id" type="tactic">assert</span> (<span class="id"
type="var">H</span> : <span class="id" type="var">P</span>); [ | <span
class="id" type="var">cont</span>(<span class="id" type="var">t</span>
<span class="id" type="var">H</span>); <span class="id"
type="tactic">clear</span> <span class="id" type="var">H</span> ].\
\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">app\_evar</span> <span class="id" type="var">t</span> <span
class="id" type="var">A</span> <span class="id" type="var">cont</span>
:=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">x</span> := <span class="id" type="tactic">fresh</span>
"TEMP" <span class="id" type="keyword">in</span>\
   <span class="id" type="var">evar</span> (<span class="id"
type="var">x</span>:<span class="id" type="var">A</span>);\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">t'</span> := <span class="id" type="var">constr</span>:(<span
class="id" type="var">t</span> <span class="id" type="var">x</span>)
<span class="id" type="keyword">in</span>\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">t''</span> := (<span class="id" type="var">eval</span> <span
class="id" type="tactic">unfold</span> <span class="id"
type="var">x</span> <span class="id" type="keyword">in</span> <span
class="id" type="var">t'</span>) <span class="id"
type="keyword">in</span>\
   <span class="id" type="tactic">subst</span> <span class="id"
type="var">x</span>; <span class="id" type="var">cont</span> <span
class="id" type="var">t''</span>.\
\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">app\_arg</span> <span class="id" type="var">t</span> <span
class="id" type="var">P</span> <span class="id" type="var">v</span>
<span class="id" type="var">cont</span> :=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">H</span> := <span class="id" type="tactic">fresh</span>
"TEMP" <span class="id" type="keyword">in</span>\
   <span class="id" type="tactic">assert</span> (<span class="id"
type="var">H</span> : <span class="id" type="var">P</span>); [ <span
class="id" type="tactic">apply</span> <span class="id"
type="var">v</span> | <span class="id" type="var">cont</span>(<span
class="id" type="var">t</span> <span class="id" type="var">H</span>);
<span class="id" type="tactic">try</span> <span class="id"
type="tactic">clear</span> <span class="id" type="var">H</span> ].\
\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">build\_app\_alls</span> <span class="id" type="var">t</span>
<span class="id" type="var">final</span> :=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">rec</span> <span class="id" type="var">go</span> <span
class="id" type="var">t</span> :=\
     <span class="id" type="keyword">match</span> <span class="id"
type="var">type</span> <span class="id" type="var">of</span> <span
class="id" type="var">t</span> <span class="id"
type="keyword">with</span>\
     | ?<span class="id" type="var">P</span> <span
style="font-family: arial;">→</span> ?<span class="id"
type="var">Q</span> ⇒ <span class="id" type="var">app\_assert</span>
<span class="id" type="var">t</span> <span class="id"
type="var">P</span> <span class="id" type="var">go</span>\
     | <span style="font-family: arial;">∀</span><span class="id"
type="var">\_</span>:?<span class="id" type="var">A</span>, <span
class="id" type="var">\_</span> ⇒ <span class="id"
type="var">app\_evar</span> <span class="id" type="var">t</span> <span
class="id" type="var">A</span> <span class="id" type="var">go</span>\
     | <span class="id" type="var">\_</span> ⇒ <span class="id"
type="var">final</span> <span class="id" type="var">t</span>\
     <span class="id" type="keyword">end</span> <span class="id"
type="keyword">in</span>\
   <span class="id" type="var">go</span> <span class="id"
type="var">t</span>.\
\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">boxerlist\_next\_type</span> <span class="id"
type="var">vs</span> :=\
   <span class="id" type="keyword">match</span> <span class="id"
type="var">vs</span> <span class="id" type="keyword">with</span>\
   | <span class="id" type="var">nil</span> ⇒ <span class="id"
type="var">constr</span>:(<span class="id"
type="var">ltac\_wild</span>)\
   | (<span class="id" type="var">boxer</span> <span class="id"
type="var">ltac\_wild</span>)::?<span class="id" type="var">vs'</span> ⇒
<span class="id" type="var">boxerlist\_next\_type</span> <span
class="id" type="var">vs'</span>\
   | (<span class="id" type="var">boxer</span> <span class="id"
type="var">ltac\_wilds</span>)::\_ ⇒ <span class="id"
type="var">constr</span>:(<span class="id"
type="var">ltac\_wild</span>)\
   | (@<span class="id" type="var">boxer</span> ?<span class="id"
type="var">T</span> <span class="id" type="var">\_</span>)::\_ ⇒ <span
class="id" type="var">constr</span>:(<span class="id"
type="var">T</span>)\
   <span class="id" type="keyword">end</span>.\
\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">build\_app\_hnts</span> <span class="id" type="var">t</span>
<span class="id" type="var">vs</span> <span class="id"
type="var">final</span> :=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">rec</span> <span class="id" type="var">go</span> <span
class="id" type="var">t</span> <span class="id" type="var">vs</span> :=\
     <span class="id" type="keyword">match</span> <span class="id"
type="var">vs</span> <span class="id" type="keyword">with</span>\
     | <span class="id" type="var">nil</span> ⇒ <span class="id"
type="var">first</span> [ <span class="id" type="var">final</span> <span
class="id" type="var">t</span> | <span class="id"
type="tactic">fail</span> 1 ]\
     | (<span class="id" type="var">boxer</span> <span class="id"
type="var">ltac\_wilds</span>)::\_ ⇒ <span class="id"
type="var">first</span> [ <span class="id"
type="var">build\_app\_alls</span> <span class="id" type="var">t</span>
<span class="id" type="var">final</span> | <span class="id"
type="tactic">fail</span> 1 ]\
     | (<span class="id" type="var">boxer</span> ?<span class="id"
type="var">v</span>)::?<span class="id" type="var">vs'</span> ⇒\
       <span class="id" type="keyword">let</span> <span class="id"
type="var">cont</span> <span class="id" type="var">t'</span> := <span
class="id" type="var">go</span> <span class="id" type="var">t'</span>
<span class="id" type="var">vs</span> <span class="id"
type="keyword">in</span>\
       <span class="id" type="keyword">let</span> <span class="id"
type="var">cont'</span> <span class="id" type="var">t'</span> := <span
class="id" type="var">go</span> <span class="id" type="var">t'</span>
<span class="id" type="var">vs'</span> <span class="id"
type="keyword">in</span>\
       <span class="id" type="keyword">let</span> <span class="id"
type="var">T</span> := <span class="id" type="var">type</span> <span
class="id" type="var">of</span> <span class="id" type="var">t</span>
<span class="id" type="keyword">in</span>\
       <span class="id" type="keyword">let</span> <span class="id"
type="var">T</span> := <span class="id" type="var">eval</span> <span
class="id" type="var">hnf</span> <span class="id"
type="keyword">in</span> <span class="id" type="var">T</span> <span
class="id" type="keyword">in</span>\
       <span class="id" type="keyword">match</span> <span class="id"
type="var">v</span> <span class="id" type="keyword">with</span>\
       | <span class="id" type="var">ltac\_wild</span> ⇒\
          <span class="id" type="var">first</span> [ <span class="id"
type="keyword">let</span> <span class="id" type="var">U</span> := <span
class="id" type="var">boxerlist\_next\_type</span> <span class="id"
type="var">vs'</span> <span class="id" type="keyword">in</span>\
            <span class="id" type="keyword">match</span> <span
class="id" type="var">U</span> <span class="id"
type="keyword">with</span>\
            | <span class="id" type="var">ltac\_wild</span> ⇒\
              <span class="id" type="keyword">match</span> <span
class="id" type="var">T</span> <span class="id"
type="keyword">with</span>\
              | ?<span class="id" type="var">P</span> <span
style="font-family: arial;">→</span> ?<span class="id"
type="var">Q</span> ⇒ <span class="id" type="var">first</span> [ <span
class="id" type="var">app\_assert</span> <span class="id"
type="var">t</span> <span class="id" type="var">P</span> <span
class="id" type="var">cont'</span> | <span class="id"
type="tactic">fail</span> 3 ]\
              | <span style="font-family: arial;">∀</span><span
class="id" type="var">\_</span>:?<span class="id" type="var">A</span>,
<span class="id" type="var">\_</span> ⇒ <span class="id"
type="var">first</span> [ <span class="id" type="var">app\_evar</span>
<span class="id" type="var">t</span> <span class="id"
type="var">A</span> <span class="id" type="var">cont'</span> | <span
class="id" type="tactic">fail</span> 3 ]\
              <span class="id" type="keyword">end</span>\
            | <span class="id" type="var">\_</span> ⇒\
              <span class="id" type="keyword">match</span> <span
class="id" type="var">T</span> <span class="id"
type="keyword">with</span> <span
class="comment">(\* should test T for unifiability \*)</span>\
              | <span class="id" type="var">U</span> <span
style="font-family: arial;">→</span> ?<span class="id"
type="var">Q</span> ⇒ <span class="id" type="var">first</span> [ <span
class="id" type="var">app\_assert</span> <span class="id"
type="var">t</span> <span class="id" type="var">U</span> <span
class="id" type="var">cont'</span> | <span class="id"
type="tactic">fail</span> 3 ]\
              | <span style="font-family: arial;">∀</span><span
class="id" type="var">\_</span>:<span class="id" type="var">U</span>,
<span class="id" type="var">\_</span> ⇒ <span class="id"
type="var">first</span> [ <span class="id" type="var">app\_evar</span>
<span class="id" type="var">t</span> <span class="id"
type="var">U</span> <span class="id" type="var">cont'</span> | <span
class="id" type="tactic">fail</span> 3 ]\
              | ?<span class="id" type="var">P</span> <span
style="font-family: arial;">→</span> ?<span class="id"
type="var">Q</span> ⇒ <span class="id" type="var">first</span> [ <span
class="id" type="var">app\_assert</span> <span class="id"
type="var">t</span> <span class="id" type="var">P</span> <span
class="id" type="var">cont</span> | <span class="id"
type="tactic">fail</span> 3 ]\
              | <span style="font-family: arial;">∀</span><span
class="id" type="var">\_</span>:?<span class="id" type="var">A</span>,
<span class="id" type="var">\_</span> ⇒ <span class="id"
type="var">first</span> [ <span class="id" type="var">app\_evar</span>
<span class="id" type="var">t</span> <span class="id"
type="var">A</span> <span class="id" type="var">cont</span> | <span
class="id" type="tactic">fail</span> 3 ]\
              <span class="id" type="keyword">end</span>\
            <span class="id" type="keyword">end</span>\
          | <span class="id" type="tactic">fail</span> 2 ]\
       | <span class="id" type="var">\_</span> ⇒\
           <span class="id" type="keyword">match</span> <span class="id"
type="var">T</span> <span class="id" type="keyword">with</span>\
           | ?<span class="id" type="var">P</span> <span
style="font-family: arial;">→</span> ?<span class="id"
type="var">Q</span> ⇒ <span class="id" type="var">first</span> [ <span
class="id" type="var">app\_arg</span> <span class="id"
type="var">t</span> <span class="id" type="var">P</span> <span
class="id" type="var">v</span> <span class="id" type="var">cont'</span>\
                               | <span class="id"
type="var">app\_assert</span> <span class="id" type="var">t</span> <span
class="id" type="var">P</span> <span class="id" type="var">cont</span>\
                               | <span class="id"
type="tactic">fail</span> 3 ]\
           | <span style="font-family: arial;">∀</span><span class="id"
type="var">\_</span>:?<span class="id" type="var">A</span>, <span
class="id" type="var">\_</span> ⇒ <span class="id"
type="var">first</span> [ <span class="id" type="var">cont'</span>
(<span class="id" type="var">t</span> <span class="id"
type="var">v</span>)\
                                     | <span class="id"
type="var">app\_evar</span> <span class="id" type="var">t</span> <span
class="id" type="var">A</span> <span class="id" type="var">cont</span>\
                                     | <span class="id"
type="tactic">fail</span> 3 ]\
           <span class="id" type="keyword">end</span>\
       <span class="id" type="keyword">end</span>\
     <span class="id" type="keyword">end</span> <span class="id"
type="keyword">in</span>\
   <span class="id" type="var">go</span> <span class="id"
type="var">t</span> <span class="id" type="var">vs</span>.\
\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">build\_app</span> <span class="id" type="var">args</span>
<span class="id" type="var">final</span> :=\
   <span class="id" type="var">first</span> [\
     <span class="id" type="keyword">match</span> <span class="id"
type="var">args</span> <span class="id" type="keyword">with</span>
(@<span class="id" type="var">boxer</span> ?<span class="id"
type="var">T</span> ?<span class="id" type="var">t</span>)::?<span
class="id" type="var">vs</span> ⇒\
       <span class="id" type="keyword">let</span> <span class="id"
type="var">t</span> := <span class="id" type="var">constr</span>:(<span
class="id" type="var">t</span>:<span class="id" type="var">T</span>)
<span class="id" type="keyword">in</span>\
       <span class="id" type="var">build\_app\_hnts</span> <span
class="id" type="var">t</span> <span class="id" type="var">vs</span>
<span class="id" type="var">final</span>\
     <span class="id" type="keyword">end</span>\
   | <span class="id" type="tactic">fail</span> 1 "Instantiation fails
for:" <span class="id" type="var">args</span>].\
\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">unfold\_head\_until\_product</span> <span class="id"
type="var">T</span> :=\
   <span class="id" type="var">eval</span> <span class="id"
type="var">hnf</span> <span class="id" type="keyword">in</span> <span
class="id" type="var">T</span>.\
\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">args\_unfold\_head\_if\_not\_product</span> <span class="id"
type="var">args</span> :=\
   <span class="id" type="keyword">match</span> <span class="id"
type="var">args</span> <span class="id" type="keyword">with</span>
(@<span class="id" type="var">boxer</span> ?<span class="id"
type="var">T</span> ?<span class="id" type="var">t</span>)::?<span
class="id" type="var">vs</span> ⇒\
     <span class="id" type="keyword">let</span> <span class="id"
type="var">T'</span> := <span class="id"
type="var">unfold\_head\_until\_product</span> <span class="id"
type="var">T</span> <span class="id" type="keyword">in</span>\
     <span class="id" type="var">constr</span>:((@<span class="id"
type="var">boxer</span> <span class="id" type="var">T'</span> <span
class="id" type="var">t</span>)::<span class="id" type="var">vs</span>)\
   <span class="id" type="keyword">end</span>.\
\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">args\_unfold\_head\_if\_not\_product\_but\_params</span>
<span class="id" type="var">args</span> :=\
   <span class="id" type="keyword">match</span> <span class="id"
type="var">args</span> <span class="id" type="keyword">with</span>\
   | (<span class="id" type="var">boxer</span> ?<span class="id"
type="var">t</span>)::(<span class="id" type="var">boxer</span> ?<span
class="id" type="var">v</span>)::?<span class="id" type="var">vs</span>
⇒\
      <span class="id"
type="var">args\_unfold\_head\_if\_not\_product</span> <span class="id"
type="var">args</span>\
   | <span class="id" type="var">\_</span> ⇒ <span class="id"
type="var">constr</span>:(<span class="id" type="var">args</span>)\
   <span class="id" type="keyword">end</span>.\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id" type="var">lets</span></span>
<span class="inlinecode"><span class="id" type="var">H</span>:</span>
<span class="inlinecode">(\>\></span> <span class="inlinecode"><span
class="id" type="var">E0</span></span> <span class="inlinecode"><span
class="id" type="var">E1</span></span> <span
class="inlinecode">..</span> <span class="inlinecode"><span class="id"
type="var">EN</span>)</span> will instantiate lemma <span
class="inlinecode"><span class="id" type="var">E0</span></span> on the
arguments <span class="inlinecode"><span class="id"
type="var">Ei</span></span> (which may be wildcards <span
class="inlinecode"><span class="id" type="var">\_\_</span></span>), and
name <span class="inlinecode"><span class="id"
type="var">H</span></span> the resulting term. <span
class="inlinecode"><span class="id" type="var">H</span></span> may be an
introduction pattern, or a sequence of introduction patterns <span
class="inlinecode"><span class="id" type="var">I1</span></span> <span
class="inlinecode"><span class="id" type="var">I2</span></span> <span
class="inlinecode"><span class="id" type="var">IN</span></span>, or
empty. Syntax <span class="inlinecode"><span class="id"
type="var">lets</span></span> <span class="inlinecode"><span class="id"
type="var">H</span>:</span> <span class="inlinecode"><span class="id"
type="var">E0</span></span> <span class="inlinecode"><span class="id"
type="var">E1</span></span> <span class="inlinecode">..</span> <span
class="inlinecode"><span class="id" type="var">EN</span></span> is also
available. If the last argument <span class="inlinecode"><span
class="id" type="var">EN</span></span> is <span class="inlinecode"><span
class="id" type="var">\_\_\_</span></span> (triple-underscore), then all
arguments of <span class="inlinecode"><span class="id"
type="var">H</span></span> will be instantiated.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">lets\_build</span> <span class="id" type="var">I</span> <span
class="id" type="var">Ei</span> :=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">args</span> := <span class="id"
type="var">list\_boxer\_of</span> <span class="id" type="var">Ei</span>
<span class="id" type="keyword">in</span>\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">args</span> := <span class="id"
type="var">args\_unfold\_head\_if\_not\_product\_but\_params</span>
<span class="id" type="var">args</span> <span class="id"
type="keyword">in</span>\
 <span
class="comment">(\*    let Ei''' := args\_unfold\_head\_if\_not\_product Ei'' in\*)</span>\
   <span class="id" type="var">build\_app</span> <span class="id"
type="var">args</span> <span class="id" type="var">ltac</span>:(<span
class="id" type="keyword">fun</span> <span class="id"
type="var">R</span> ⇒ <span class="id" type="var">lets\_base</span>
<span class="id" type="var">I</span> <span class="id"
type="var">R</span>).\
\
 <span class="id" type="keyword">Tactic Notation</span> "lets" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I</span>) ":" <span class="id" type="var">constr</span>(<span
class="id" type="var">E</span>) :=\
   <span class="id" type="var">lets\_build</span> <span class="id"
type="var">I</span> <span class="id" type="var">E</span>; <span
class="id" type="var">fast\_rm\_inside</span> <span class="id"
type="var">E</span>.\
 <span class="id" type="keyword">Tactic Notation</span> "lets" ":" <span
class="id" type="var">constr</span>(<span class="id"
type="var">E</span>) :=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">H</span> := <span class="id" type="tactic">fresh</span> <span
class="id" type="keyword">in</span> <span class="id"
type="var">lets</span> <span class="id" type="var">H</span>: <span
class="id" type="var">E</span>.\
 <span class="id" type="keyword">Tactic Notation</span> "lets" ":" <span
class="id" type="var">constr</span>(<span class="id"
type="var">E0</span>)\
  <span class="id" type="var">constr</span>(<span class="id"
type="var">A1</span>) :=\
   <span class="id" type="var">lets</span>: (\>\> <span class="id"
type="var">E0</span> <span class="id" type="var">A1</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "lets" ":" <span
class="id" type="var">constr</span>(<span class="id"
type="var">E0</span>)\
  <span class="id" type="var">constr</span>(<span class="id"
type="var">A1</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A2</span>) :=\
   <span class="id" type="var">lets</span>: (\>\> <span class="id"
type="var">E0</span> <span class="id" type="var">A1</span> <span
class="id" type="var">A2</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "lets" ":" <span
class="id" type="var">constr</span>(<span class="id"
type="var">E0</span>)\
  <span class="id" type="var">constr</span>(<span class="id"
type="var">A1</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A2</span>) <span class="id"
type="var">constr</span>(<span class="id" type="var">A3</span>) :=\
   <span class="id" type="var">lets</span>: (\>\> <span class="id"
type="var">E0</span> <span class="id" type="var">A1</span> <span
class="id" type="var">A2</span> <span class="id" type="var">A3</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "lets" ":" <span
class="id" type="var">constr</span>(<span class="id"
type="var">E0</span>)\
  <span class="id" type="var">constr</span>(<span class="id"
type="var">A1</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A2</span>) <span class="id"
type="var">constr</span>(<span class="id" type="var">A3</span>) <span
class="id" type="var">constr</span>(<span class="id"
type="var">A4</span>) :=\
   <span class="id" type="var">lets</span>: (\>\> <span class="id"
type="var">E0</span> <span class="id" type="var">A1</span> <span
class="id" type="var">A2</span> <span class="id" type="var">A3</span>
<span class="id" type="var">A4</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "lets" ":" <span
class="id" type="var">constr</span>(<span class="id"
type="var">E0</span>)\
  <span class="id" type="var">constr</span>(<span class="id"
type="var">A1</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A2</span>) <span class="id"
type="var">constr</span>(<span class="id" type="var">A3</span>) <span
class="id" type="var">constr</span>(<span class="id"
type="var">A4</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A5</span>) :=\
   <span class="id" type="var">lets</span>: (\>\> <span class="id"
type="var">E0</span> <span class="id" type="var">A1</span> <span
class="id" type="var">A2</span> <span class="id" type="var">A3</span>
<span class="id" type="var">A4</span> <span class="id"
type="var">A5</span>).\
\
 <span class="comment">(\* --todo: deprecated, do not use \*)</span>\
 <span class="id" type="keyword">Tactic Notation</span> "lets" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I1</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I2</span>)\
  ":" <span class="id" type="var">constr</span>(<span class="id"
type="var">E</span>) :=\
   <span class="id" type="var">lets</span> [<span class="id"
type="var">I1</span> <span class="id" type="var">I2</span>]: <span
class="id" type="var">E</span>.\
 <span class="id" type="keyword">Tactic Notation</span> "lets" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I1</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I2</span>)\
  <span class="id" type="var">simple\_intropattern</span>(<span
class="id" type="var">I3</span>) ":" <span class="id"
type="var">constr</span>(<span class="id" type="var">E</span>) :=\
   <span class="id" type="var">lets</span> [<span class="id"
type="var">I1</span> [<span class="id" type="var">I2</span> <span
class="id" type="var">I3</span>]]: <span class="id"
type="var">E</span>.\
 <span class="id" type="keyword">Tactic Notation</span> "lets" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I1</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I2</span>)\
  <span class="id" type="var">simple\_intropattern</span>(<span
class="id" type="var">I3</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I4</span>) ":" <span class="id"
type="var">constr</span>(<span class="id" type="var">E</span>) :=\
   <span class="id" type="var">lets</span> [<span class="id"
type="var">I1</span> [<span class="id" type="var">I2</span> [<span
class="id" type="var">I3</span> <span class="id"
type="var">I4</span>]]]: <span class="id" type="var">E</span>.\
 <span class="id" type="keyword">Tactic Notation</span> "lets" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I1</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I2</span>)\
  <span class="id" type="var">simple\_intropattern</span>(<span
class="id" type="var">I3</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I4</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I5</span>)\
  ":" <span class="id" type="var">constr</span>(<span class="id"
type="var">E</span>) :=\
   <span class="id" type="var">lets</span> [<span class="id"
type="var">I1</span> [<span class="id" type="var">I2</span> [<span
class="id" type="var">I3</span> [<span class="id" type="var">I4</span>
<span class="id" type="var">I5</span>]]]]: <span class="id"
type="var">E</span>.\
\
 <span class="id" type="keyword">Tactic Notation</span> "lets" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I</span>) ":" <span class="id" type="var">constr</span>(<span
class="id" type="var">E0</span>)\
  <span class="id" type="var">constr</span>(<span class="id"
type="var">A1</span>) :=\
   <span class="id" type="var">lets</span> <span class="id"
type="var">I</span>: (\>\> <span class="id" type="var">E0</span> <span
class="id" type="var">A1</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "lets" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I</span>) ":" <span class="id" type="var">constr</span>(<span
class="id" type="var">E0</span>)\
  <span class="id" type="var">constr</span>(<span class="id"
type="var">A1</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A2</span>) :=\
   <span class="id" type="var">lets</span> <span class="id"
type="var">I</span>: (\>\> <span class="id" type="var">E0</span> <span
class="id" type="var">A1</span> <span class="id" type="var">A2</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "lets" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I</span>) ":" <span class="id" type="var">constr</span>(<span
class="id" type="var">E0</span>)\
  <span class="id" type="var">constr</span>(<span class="id"
type="var">A1</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A2</span>) <span class="id"
type="var">constr</span>(<span class="id" type="var">A3</span>) :=\
   <span class="id" type="var">lets</span> <span class="id"
type="var">I</span>: (\>\> <span class="id" type="var">E0</span> <span
class="id" type="var">A1</span> <span class="id" type="var">A2</span>
<span class="id" type="var">A3</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "lets" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I</span>) ":" <span class="id" type="var">constr</span>(<span
class="id" type="var">E0</span>)\
  <span class="id" type="var">constr</span>(<span class="id"
type="var">A1</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A2</span>) <span class="id"
type="var">constr</span>(<span class="id" type="var">A3</span>) <span
class="id" type="var">constr</span>(<span class="id"
type="var">A4</span>) :=\
   <span class="id" type="var">lets</span> <span class="id"
type="var">I</span>: (\>\> <span class="id" type="var">E0</span> <span
class="id" type="var">A1</span> <span class="id" type="var">A2</span>
<span class="id" type="var">A3</span> <span class="id"
type="var">A4</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "lets" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I</span>) ":" <span class="id" type="var">constr</span>(<span
class="id" type="var">E0</span>)\
  <span class="id" type="var">constr</span>(<span class="id"
type="var">A1</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A2</span>) <span class="id"
type="var">constr</span>(<span class="id" type="var">A3</span>) <span
class="id" type="var">constr</span>(<span class="id"
type="var">A4</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A5</span>) :=\
   <span class="id" type="var">lets</span> <span class="id"
type="var">I</span>: (\>\> <span class="id" type="var">E0</span> <span
class="id" type="var">A1</span> <span class="id" type="var">A2</span>
<span class="id" type="var">A3</span> <span class="id"
type="var">A4</span> <span class="id" type="var">A5</span>).\
\
 <span class="id" type="keyword">Tactic Notation</span> "lets" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I1</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I2</span>) ":" <span class="id"
type="var">constr</span>(<span class="id" type="var">E0</span>)\
  <span class="id" type="var">constr</span>(<span class="id"
type="var">A1</span>) :=\
   <span class="id" type="var">lets</span> [<span class="id"
type="var">I1</span> <span class="id" type="var">I2</span>]: <span
class="id" type="var">E0</span> <span class="id" type="var">A1</span>.\
 <span class="id" type="keyword">Tactic Notation</span> "lets" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I1</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I2</span>) ":" <span class="id"
type="var">constr</span>(<span class="id" type="var">E0</span>)\
  <span class="id" type="var">constr</span>(<span class="id"
type="var">A1</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A2</span>) :=\
   <span class="id" type="var">lets</span> [<span class="id"
type="var">I1</span> <span class="id" type="var">I2</span>]: <span
class="id" type="var">E0</span> <span class="id" type="var">A1</span>
<span class="id" type="var">A2</span>.\
 <span class="id" type="keyword">Tactic Notation</span> "lets" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I1</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I2</span>) ":" <span class="id"
type="var">constr</span>(<span class="id" type="var">E0</span>)\
  <span class="id" type="var">constr</span>(<span class="id"
type="var">A1</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A2</span>) <span class="id"
type="var">constr</span>(<span class="id" type="var">A3</span>) :=\
   <span class="id" type="var">lets</span> [<span class="id"
type="var">I1</span> <span class="id" type="var">I2</span>]: <span
class="id" type="var">E0</span> <span class="id" type="var">A1</span>
<span class="id" type="var">A2</span> <span class="id"
type="var">A3</span>.\
 <span class="id" type="keyword">Tactic Notation</span> "lets" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I1</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I2</span>) ":" <span class="id"
type="var">constr</span>(<span class="id" type="var">E0</span>)\
  <span class="id" type="var">constr</span>(<span class="id"
type="var">A1</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A2</span>) <span class="id"
type="var">constr</span>(<span class="id" type="var">A3</span>) <span
class="id" type="var">constr</span>(<span class="id"
type="var">A4</span>) :=\
   <span class="id" type="var">lets</span> [<span class="id"
type="var">I1</span> <span class="id" type="var">I2</span>]: <span
class="id" type="var">E0</span> <span class="id" type="var">A1</span>
<span class="id" type="var">A2</span> <span class="id"
type="var">A3</span> <span class="id" type="var">A4</span>.\
 <span class="id" type="keyword">Tactic Notation</span> "lets" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I1</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I2</span>) ":" <span class="id"
type="var">constr</span>(<span class="id" type="var">E0</span>)\
  <span class="id" type="var">constr</span>(<span class="id"
type="var">A1</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A2</span>) <span class="id"
type="var">constr</span>(<span class="id" type="var">A3</span>) <span
class="id" type="var">constr</span>(<span class="id"
type="var">A4</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A5</span>) :=\
   <span class="id" type="var">lets</span> [<span class="id"
type="var">I1</span> <span class="id" type="var">I2</span>]: <span
class="id" type="var">E0</span> <span class="id" type="var">A1</span>
<span class="id" type="var">A2</span> <span class="id"
type="var">A3</span> <span class="id" type="var">A4</span> <span
class="id" type="var">A5</span>.\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id"
type="var">forwards</span></span> <span class="inlinecode"><span
class="id" type="var">H</span>:</span> <span
class="inlinecode">(\>\></span> <span class="inlinecode"><span
class="id" type="var">E0</span></span> <span class="inlinecode"><span
class="id" type="var">E1</span></span> <span
class="inlinecode">..</span> <span class="inlinecode"><span class="id"
type="var">EN</span>)</span> is short for <span class="inlinecode"><span
class="id" type="var">forwards</span></span> <span
class="inlinecode"><span class="id" type="var">H</span>:</span> <span
class="inlinecode">(\>\></span> <span class="inlinecode"><span
class="id" type="var">E0</span></span> <span class="inlinecode"><span
class="id" type="var">E1</span></span> <span
class="inlinecode">..</span> <span class="inlinecode"><span class="id"
type="var">EN</span></span> <span class="inlinecode"><span class="id"
type="var">\_\_\_</span>)</span>. The arguments <span
class="inlinecode"><span class="id" type="var">Ei</span></span> can be
wildcards <span class="inlinecode"><span class="id"
type="var">\_\_</span></span> (except <span class="inlinecode"><span
class="id" type="var">E0</span></span>). <span class="inlinecode"><span
class="id" type="var">H</span></span> may be an introduction pattern, or
a sequence of introduction pattern, or empty. Syntax <span
class="inlinecode"><span class="id" type="var">forwards</span></span>
<span class="inlinecode"><span class="id" type="var">H</span>:</span>
<span class="inlinecode"><span class="id" type="var">E0</span></span>
<span class="inlinecode"><span class="id" type="var">E1</span></span>
<span class="inlinecode">..</span> <span class="inlinecode"><span
class="id" type="var">EN</span></span> is also available.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">forwards\_build\_app\_arg</span> <span class="id"
type="var">Ei</span> :=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">args</span> := <span class="id"
type="var">list\_boxer\_of</span> <span class="id" type="var">Ei</span>
<span class="id" type="keyword">in</span>\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">args</span> := (<span class="id" type="var">eval</span> <span
class="id" type="tactic">simpl</span> <span class="id"
type="keyword">in</span> (<span class="id" type="var">args</span> ++
((<span class="id" type="var">boxer</span> <span class="id"
type="var">\_\_\_</span>)::<span class="id" type="var">nil</span>)))
<span class="id" type="keyword">in</span>\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">args</span> := <span class="id"
type="var">args\_unfold\_head\_if\_not\_product</span> <span class="id"
type="var">args</span> <span class="id" type="keyword">in</span>\
   <span class="id" type="var">args</span>.\
\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">forwards\_then</span> <span class="id" type="var">Ei</span>
<span class="id" type="var">cont</span> :=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">args</span> := <span class="id"
type="var">forwards\_build\_app\_arg</span> <span class="id"
type="var">Ei</span> <span class="id" type="keyword">in</span>\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">args</span> := <span class="id"
type="var">args\_unfold\_head\_if\_not\_product\_but\_params</span>
<span class="id" type="var">args</span> <span class="id"
type="keyword">in</span>\
   <span class="id" type="var">build\_app</span> <span class="id"
type="var">args</span> <span class="id" type="var">cont</span>.\
\
 <span class="id" type="keyword">Tactic Notation</span> "forwards" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I</span>) ":" <span class="id" type="var">constr</span>(<span
class="id" type="var">Ei</span>) :=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">args</span> := <span class="id"
type="var">forwards\_build\_app\_arg</span> <span class="id"
type="var">Ei</span> <span class="id" type="keyword">in</span>\
   <span class="id" type="var">lets</span> <span class="id"
type="var">I</span>: <span class="id" type="var">args</span>.\
\
 <span class="id" type="keyword">Tactic Notation</span> "forwards" ":"
<span class="id" type="var">constr</span>(<span class="id"
type="var">E</span>) :=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">H</span> := <span class="id" type="tactic">fresh</span> <span
class="id" type="keyword">in</span> <span class="id"
type="var">forwards</span> <span class="id" type="var">H</span>: <span
class="id" type="var">E</span>.\
 <span class="id" type="keyword">Tactic Notation</span> "forwards" ":"
<span class="id" type="var">constr</span>(<span class="id"
type="var">E0</span>)\
  <span class="id" type="var">constr</span>(<span class="id"
type="var">A1</span>) :=\
   <span class="id" type="var">forwards</span>: (\>\> <span class="id"
type="var">E0</span> <span class="id" type="var">A1</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "forwards" ":"
<span class="id" type="var">constr</span>(<span class="id"
type="var">E0</span>)\
  <span class="id" type="var">constr</span>(<span class="id"
type="var">A1</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A2</span>) :=\
   <span class="id" type="var">forwards</span>: (\>\> <span class="id"
type="var">E0</span> <span class="id" type="var">A1</span> <span
class="id" type="var">A2</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "forwards" ":"
<span class="id" type="var">constr</span>(<span class="id"
type="var">E0</span>)\
  <span class="id" type="var">constr</span>(<span class="id"
type="var">A1</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A2</span>) <span class="id"
type="var">constr</span>(<span class="id" type="var">A3</span>) :=\
   <span class="id" type="var">forwards</span>: (\>\> <span class="id"
type="var">E0</span> <span class="id" type="var">A1</span> <span
class="id" type="var">A2</span> <span class="id" type="var">A3</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "forwards" ":"
<span class="id" type="var">constr</span>(<span class="id"
type="var">E0</span>)\
  <span class="id" type="var">constr</span>(<span class="id"
type="var">A1</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A2</span>) <span class="id"
type="var">constr</span>(<span class="id" type="var">A3</span>) <span
class="id" type="var">constr</span>(<span class="id"
type="var">A4</span>) :=\
   <span class="id" type="var">forwards</span>: (\>\> <span class="id"
type="var">E0</span> <span class="id" type="var">A1</span> <span
class="id" type="var">A2</span> <span class="id" type="var">A3</span>
<span class="id" type="var">A4</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "forwards" ":"
<span class="id" type="var">constr</span>(<span class="id"
type="var">E0</span>)\
  <span class="id" type="var">constr</span>(<span class="id"
type="var">A1</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A2</span>) <span class="id"
type="var">constr</span>(<span class="id" type="var">A3</span>) <span
class="id" type="var">constr</span>(<span class="id"
type="var">A4</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A5</span>) :=\
   <span class="id" type="var">forwards</span>: (\>\> <span class="id"
type="var">E0</span> <span class="id" type="var">A1</span> <span
class="id" type="var">A2</span> <span class="id" type="var">A3</span>
<span class="id" type="var">A4</span> <span class="id"
type="var">A5</span>).\
\
 <span class="comment">(\* todo: deprecated, do not use \*)</span>\
 <span class="id" type="keyword">Tactic Notation</span> "forwards" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I1</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I2</span>)\
  ":" <span class="id" type="var">constr</span>(<span class="id"
type="var">E</span>) :=\
   <span class="id" type="var">forwards</span> [<span class="id"
type="var">I1</span> <span class="id" type="var">I2</span>]: <span
class="id" type="var">E</span>.\
 <span class="id" type="keyword">Tactic Notation</span> "forwards" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I1</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I2</span>)\
  <span class="id" type="var">simple\_intropattern</span>(<span
class="id" type="var">I3</span>) ":" <span class="id"
type="var">constr</span>(<span class="id" type="var">E</span>) :=\
   <span class="id" type="var">forwards</span> [<span class="id"
type="var">I1</span> [<span class="id" type="var">I2</span> <span
class="id" type="var">I3</span>]]: <span class="id"
type="var">E</span>.\
 <span class="id" type="keyword">Tactic Notation</span> "forwards" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I1</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I2</span>)\
  <span class="id" type="var">simple\_intropattern</span>(<span
class="id" type="var">I3</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I4</span>) ":" <span class="id"
type="var">constr</span>(<span class="id" type="var">E</span>) :=\
   <span class="id" type="var">forwards</span> [<span class="id"
type="var">I1</span> [<span class="id" type="var">I2</span> [<span
class="id" type="var">I3</span> <span class="id"
type="var">I4</span>]]]: <span class="id" type="var">E</span>.\
 <span class="id" type="keyword">Tactic Notation</span> "forwards" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I1</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I2</span>)\
  <span class="id" type="var">simple\_intropattern</span>(<span
class="id" type="var">I3</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I4</span>) <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I5</span>)\
  ":" <span class="id" type="var">constr</span>(<span class="id"
type="var">E</span>) :=\
   <span class="id" type="var">forwards</span> [<span class="id"
type="var">I1</span> [<span class="id" type="var">I2</span> [<span
class="id" type="var">I3</span> [<span class="id" type="var">I4</span>
<span class="id" type="var">I5</span>]]]]: <span class="id"
type="var">E</span>.\
\
 <span class="id" type="keyword">Tactic Notation</span> "forwards" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I</span>) ":" <span class="id" type="var">constr</span>(<span
class="id" type="var">E0</span>)\
  <span class="id" type="var">constr</span>(<span class="id"
type="var">A1</span>) :=\
   <span class="id" type="var">forwards</span> <span class="id"
type="var">I</span>: (\>\> <span class="id" type="var">E0</span> <span
class="id" type="var">A1</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "forwards" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I</span>) ":" <span class="id" type="var">constr</span>(<span
class="id" type="var">E0</span>)\
  <span class="id" type="var">constr</span>(<span class="id"
type="var">A1</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A2</span>) :=\
   <span class="id" type="var">forwards</span> <span class="id"
type="var">I</span>: (\>\> <span class="id" type="var">E0</span> <span
class="id" type="var">A1</span> <span class="id" type="var">A2</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "forwards" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I</span>) ":" <span class="id" type="var">constr</span>(<span
class="id" type="var">E0</span>)\
  <span class="id" type="var">constr</span>(<span class="id"
type="var">A1</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A2</span>) <span class="id"
type="var">constr</span>(<span class="id" type="var">A3</span>) :=\
   <span class="id" type="var">forwards</span> <span class="id"
type="var">I</span>: (\>\> <span class="id" type="var">E0</span> <span
class="id" type="var">A1</span> <span class="id" type="var">A2</span>
<span class="id" type="var">A3</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "forwards" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I</span>) ":" <span class="id" type="var">constr</span>(<span
class="id" type="var">E0</span>)\
  <span class="id" type="var">constr</span>(<span class="id"
type="var">A1</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A2</span>) <span class="id"
type="var">constr</span>(<span class="id" type="var">A3</span>) <span
class="id" type="var">constr</span>(<span class="id"
type="var">A4</span>) :=\
   <span class="id" type="var">forwards</span> <span class="id"
type="var">I</span>: (\>\> <span class="id" type="var">E0</span> <span
class="id" type="var">A1</span> <span class="id" type="var">A2</span>
<span class="id" type="var">A3</span> <span class="id"
type="var">A4</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "forwards" <span
class="id" type="var">simple\_intropattern</span>(<span class="id"
type="var">I</span>) ":" <span class="id" type="var">constr</span>(<span
class="id" type="var">E0</span>)\
  <span class="id" type="var">constr</span>(<span class="id"
type="var">A1</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A2</span>) <span class="id"
type="var">constr</span>(<span class="id" type="var">A3</span>) <span
class="id" type="var">constr</span>(<span class="id"
type="var">A4</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A5</span>) :=\
   <span class="id" type="var">forwards</span> <span class="id"
type="var">I</span>: (\>\> <span class="id" type="var">E0</span> <span
class="id" type="var">A1</span> <span class="id" type="var">A2</span>
<span class="id" type="var">A3</span> <span class="id"
type="var">A4</span> <span class="id" type="var">A5</span>).\
\
   <span
class="comment">(\* for use by tactics -- todo: factorize better \*)</span>\
 <span class="id" type="keyword">Tactic Notation</span>
"forwards\_nounfold" <span class="id"
type="var">simple\_intropattern</span>(<span class="id"
type="var">I</span>) ":" <span class="id" type="var">constr</span>(<span
class="id" type="var">Ei</span>) :=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">args</span> := <span class="id"
type="var">list\_boxer\_of</span> <span class="id" type="var">Ei</span>
<span class="id" type="keyword">in</span>\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">args</span> := (<span class="id" type="var">eval</span> <span
class="id" type="tactic">simpl</span> <span class="id"
type="keyword">in</span> (<span class="id" type="var">args</span> ++
((<span class="id" type="var">boxer</span> <span class="id"
type="var">\_\_\_</span>)::<span class="id" type="var">nil</span>)))
<span class="id" type="keyword">in</span>\
   <span class="id" type="var">build\_app</span> <span class="id"
type="var">args</span> <span class="id" type="var">ltac</span>:(<span
class="id" type="keyword">fun</span> <span class="id"
type="var">R</span> ⇒ <span class="id" type="var">lets\_base</span>
<span class="id" type="var">I</span> <span class="id"
type="var">R</span>);\
   <span class="id" type="var">fast\_rm\_inside</span> <span class="id"
type="var">Ei</span>.\
\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">forwards\_nounfold\_then</span> <span class="id"
type="var">Ei</span> <span class="id" type="var">cont</span> :=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">args</span> := <span class="id"
type="var">list\_boxer\_of</span> <span class="id" type="var">Ei</span>
<span class="id" type="keyword">in</span>\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">args</span> := (<span class="id" type="var">eval</span> <span
class="id" type="tactic">simpl</span> <span class="id"
type="keyword">in</span> (<span class="id" type="var">args</span> ++
((<span class="id" type="var">boxer</span> <span class="id"
type="var">\_\_\_</span>)::<span class="id" type="var">nil</span>)))
<span class="id" type="keyword">in</span>\
   <span class="id" type="var">build\_app</span> <span class="id"
type="var">args</span> <span class="id" type="var">cont</span>;\
   <span class="id" type="var">fast\_rm\_inside</span> <span class="id"
type="var">Ei</span>.\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id"
type="var">applys</span></span> <span class="inlinecode">(\>\></span>
<span class="inlinecode"><span class="id" type="var">E0</span></span>
<span class="inlinecode"><span class="id" type="var">E1</span></span>
<span class="inlinecode">..</span> <span class="inlinecode"><span
class="id" type="var">EN</span>)</span> instantiates lemma <span
class="inlinecode"><span class="id" type="var">E0</span></span> on the
arguments <span class="inlinecode"><span class="id"
type="var">Ei</span></span> (which may be wildcards <span
class="inlinecode"><span class="id" type="var">\_\_</span></span>), and
apply the resulting term to the current goal, using the tactic <span
class="inlinecode"><span class="id" type="var">applys</span></span>
defined earlier on. <span class="inlinecode"><span class="id"
type="var">applys</span></span> <span class="inlinecode"><span
class="id" type="var">E0</span></span> <span class="inlinecode"><span
class="id" type="var">E1</span></span> <span class="inlinecode"><span
class="id" type="var">E2</span></span> <span
class="inlinecode">..</span> <span class="inlinecode"><span class="id"
type="var">EN</span></span> is also available.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">applys\_build</span> <span class="id" type="var">Ei</span>
:=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">args</span> := <span class="id"
type="var">list\_boxer\_of</span> <span class="id" type="var">Ei</span>
<span class="id" type="keyword">in</span>\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">args</span> := <span class="id"
type="var">args\_unfold\_head\_if\_not\_product\_but\_params</span>
<span class="id" type="var">args</span> <span class="id"
type="keyword">in</span>\
   <span class="id" type="var">build\_app</span> <span class="id"
type="var">args</span> <span class="id" type="var">ltac</span>:(<span
class="id" type="keyword">fun</span> <span class="id"
type="var">R</span> ⇒\
    <span class="id" type="var">first</span> [ <span class="id"
type="tactic">apply</span> <span class="id" type="var">R</span> | <span
class="id" type="tactic">eapply</span> <span class="id"
type="var">R</span> | <span class="id" type="var">rapply</span> <span
class="id" type="var">R</span> ]).\
\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">applys\_base</span> <span class="id" type="var">E</span> :=\
   <span class="id" type="keyword">match</span> <span class="id"
type="var">type</span> <span class="id" type="var">of</span> <span
class="id" type="var">E</span> <span class="id"
type="keyword">with</span>\
   | <span class="id" type="var">list</span> <span class="id"
type="var">Boxer</span> ⇒ <span class="id"
type="var">applys\_build</span> <span class="id" type="var">E</span>\
   | <span class="id" type="var">\_</span> ⇒ <span class="id"
type="var">first</span> [ <span class="id" type="var">rapply</span>
<span class="id" type="var">E</span> | <span class="id"
type="var">applys\_build</span> <span class="id" type="var">E</span> ]\
   <span class="id" type="keyword">end</span>; <span class="id"
type="var">fast\_rm\_inside</span> <span class="id"
type="var">E</span>.\
\
 <span class="id" type="keyword">Tactic Notation</span> "applys" <span
class="id" type="var">constr</span>(<span class="id"
type="var">E</span>) :=\
   <span class="id" type="var">applys\_base</span> <span class="id"
type="var">E</span>.\
 <span class="id" type="keyword">Tactic Notation</span> "applys" <span
class="id" type="var">constr</span>(<span class="id"
type="var">E0</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A1</span>) :=\
   <span class="id" type="var">applys</span> (\>\> <span class="id"
type="var">E0</span> <span class="id" type="var">A1</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "applys" <span
class="id" type="var">constr</span>(<span class="id"
type="var">E0</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A1</span>) <span class="id"
type="var">constr</span>(<span class="id" type="var">A2</span>) :=\
   <span class="id" type="var">applys</span> (\>\> <span class="id"
type="var">E0</span> <span class="id" type="var">A1</span> <span
class="id" type="var">A2</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "applys" <span
class="id" type="var">constr</span>(<span class="id"
type="var">E0</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A1</span>) <span class="id"
type="var">constr</span>(<span class="id" type="var">A2</span>) <span
class="id" type="var">constr</span>(<span class="id"
type="var">A3</span>) :=\
   <span class="id" type="var">applys</span> (\>\> <span class="id"
type="var">E0</span> <span class="id" type="var">A1</span> <span
class="id" type="var">A2</span> <span class="id" type="var">A3</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "applys" <span
class="id" type="var">constr</span>(<span class="id"
type="var">E0</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A1</span>) <span class="id"
type="var">constr</span>(<span class="id" type="var">A2</span>) <span
class="id" type="var">constr</span>(<span class="id"
type="var">A3</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A4</span>) :=\
   <span class="id" type="var">applys</span> (\>\> <span class="id"
type="var">E0</span> <span class="id" type="var">A1</span> <span
class="id" type="var">A2</span> <span class="id" type="var">A3</span>
<span class="id" type="var">A4</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "applys" <span
class="id" type="var">constr</span>(<span class="id"
type="var">E0</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A1</span>) <span class="id"
type="var">constr</span>(<span class="id" type="var">A2</span>) <span
class="id" type="var">constr</span>(<span class="id"
type="var">A3</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A4</span>) <span class="id"
type="var">constr</span>(<span class="id" type="var">A5</span>) :=\
   <span class="id" type="var">applys</span> (\>\> <span class="id"
type="var">E0</span> <span class="id" type="var">A1</span> <span
class="id" type="var">A2</span> <span class="id" type="var">A3</span>
<span class="id" type="var">A4</span> <span class="id"
type="var">A5</span>).\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id"
type="var">fapplys</span></span> <span class="inlinecode">(\>\></span>
<span class="inlinecode"><span class="id" type="var">E0</span></span>
<span class="inlinecode"><span class="id" type="var">E1</span></span>
<span class="inlinecode">..</span> <span class="inlinecode"><span
class="id" type="var">EN</span>)</span> instantiates lemma <span
class="inlinecode"><span class="id" type="var">E0</span></span> on the
arguments <span class="inlinecode"><span class="id"
type="var">Ei</span></span> and on the argument <span
class="inlinecode"><span class="id" type="var">\_\_\_</span></span>
meaning that all evars should be explicitly instantiated, and apply the
resulting term to the current goal. <span class="inlinecode"><span
class="id" type="var">fapplys</span></span> <span
class="inlinecode"><span class="id" type="var">E0</span></span> <span
class="inlinecode"><span class="id" type="var">E1</span></span> <span
class="inlinecode"><span class="id" type="var">E2</span></span> <span
class="inlinecode">..</span> <span class="inlinecode"><span class="id"
type="var">EN</span></span> is also available.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">fapplys\_build</span> <span class="id" type="var">Ei</span>
:=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">args</span> := <span class="id"
type="var">list\_boxer\_of</span> <span class="id" type="var">Ei</span>
<span class="id" type="keyword">in</span>\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">args</span> := (<span class="id" type="var">eval</span> <span
class="id" type="tactic">simpl</span> <span class="id"
type="keyword">in</span> (<span class="id" type="var">args</span> ++
((<span class="id" type="var">boxer</span> <span class="id"
type="var">\_\_\_</span>)::<span class="id" type="var">nil</span>)))
<span class="id" type="keyword">in</span>\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">args</span> := <span class="id"
type="var">args\_unfold\_head\_if\_not\_product\_but\_params</span>
<span class="id" type="var">args</span> <span class="id"
type="keyword">in</span>\
   <span class="id" type="var">build\_app</span> <span class="id"
type="var">args</span> <span class="id" type="var">ltac</span>:(<span
class="id" type="keyword">fun</span> <span class="id"
type="var">R</span> ⇒ <span class="id" type="tactic">apply</span> <span
class="id" type="var">R</span>).\
\
 <span class="id" type="keyword">Tactic Notation</span> "fapplys" <span
class="id" type="var">constr</span>(<span class="id"
type="var">E0</span>) := <span
class="comment">(\* todo: use the tactic for that\*)</span>\
   <span class="id" type="keyword">match</span> <span class="id"
type="var">type</span> <span class="id" type="var">of</span> <span
class="id" type="var">E0</span> <span class="id"
type="keyword">with</span>\
   | <span class="id" type="var">list</span> <span class="id"
type="var">Boxer</span> ⇒ <span class="id"
type="var">fapplys\_build</span> <span class="id" type="var">E0</span>\
   | <span class="id" type="var">\_</span> ⇒ <span class="id"
type="var">fapplys\_build</span> (\>\> <span class="id"
type="var">E0</span>)\
   <span class="id" type="keyword">end</span>.\
 <span class="id" type="keyword">Tactic Notation</span> "fapplys" <span
class="id" type="var">constr</span>(<span class="id"
type="var">E0</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A1</span>) :=\
   <span class="id" type="var">fapplys</span> (\>\> <span class="id"
type="var">E0</span> <span class="id" type="var">A1</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "fapplys" <span
class="id" type="var">constr</span>(<span class="id"
type="var">E0</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A1</span>) <span class="id"
type="var">constr</span>(<span class="id" type="var">A2</span>) :=\
   <span class="id" type="var">fapplys</span> (\>\> <span class="id"
type="var">E0</span> <span class="id" type="var">A1</span> <span
class="id" type="var">A2</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "fapplys" <span
class="id" type="var">constr</span>(<span class="id"
type="var">E0</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A1</span>) <span class="id"
type="var">constr</span>(<span class="id" type="var">A2</span>) <span
class="id" type="var">constr</span>(<span class="id"
type="var">A3</span>) :=\
   <span class="id" type="var">fapplys</span> (\>\> <span class="id"
type="var">E0</span> <span class="id" type="var">A1</span> <span
class="id" type="var">A2</span> <span class="id" type="var">A3</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "fapplys" <span
class="id" type="var">constr</span>(<span class="id"
type="var">E0</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A1</span>) <span class="id"
type="var">constr</span>(<span class="id" type="var">A2</span>) <span
class="id" type="var">constr</span>(<span class="id"
type="var">A3</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A4</span>) :=\
   <span class="id" type="var">fapplys</span> (\>\> <span class="id"
type="var">E0</span> <span class="id" type="var">A1</span> <span
class="id" type="var">A2</span> <span class="id" type="var">A3</span>
<span class="id" type="var">A4</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "fapplys" <span
class="id" type="var">constr</span>(<span class="id"
type="var">E0</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A1</span>) <span class="id"
type="var">constr</span>(<span class="id" type="var">A2</span>) <span
class="id" type="var">constr</span>(<span class="id"
type="var">A3</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A4</span>) <span class="id"
type="var">constr</span>(<span class="id" type="var">A5</span>) :=\
   <span class="id" type="var">fapplys</span> (\>\> <span class="id"
type="var">E0</span> <span class="id" type="var">A1</span> <span
class="id" type="var">A2</span> <span class="id" type="var">A3</span>
<span class="id" type="var">A4</span> <span class="id"
type="var">A5</span>).\
\

</div>

<div class="doc">

<span class="inlinecode"><span class="id"
type="var">specializes</span></span> <span class="inlinecode"><span
class="id" type="var">H</span></span> <span
class="inlinecode">(\>\></span> <span class="inlinecode"><span
class="id" type="var">E1</span></span> <span class="inlinecode"><span
class="id" type="var">E2</span></span> <span
class="inlinecode">..</span> <span class="inlinecode"><span class="id"
type="var">EN</span>)</span> will instantiate hypothesis <span
class="inlinecode"><span class="id" type="var">H</span></span> on the
arguments <span class="inlinecode"><span class="id"
type="var">Ei</span></span> (which may be wildcards <span
class="inlinecode"><span class="id" type="var">\_\_</span></span>). If
the last argument <span class="inlinecode"><span class="id"
type="var">EN</span></span> is <span class="inlinecode"><span class="id"
type="var">\_\_\_</span></span> (triple-underscore), then all arguments
of <span class="inlinecode"><span class="id" type="var">H</span></span>
get instantiated.

</div>

<div class="code code-tight">

\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">specializes\_build</span> <span class="id"
type="var">H</span> <span class="id" type="var">Ei</span> :=\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">H'</span> := <span class="id" type="tactic">fresh</span>
"TEMP" <span class="id" type="keyword">in</span> <span class="id"
type="tactic">rename</span> <span class="id" type="var">H</span> <span
class="id" type="var">into</span> <span class="id"
type="var">H'</span>;\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">args</span> := <span class="id"
type="var">list\_boxer\_of</span> <span class="id" type="var">Ei</span>
<span class="id" type="keyword">in</span>\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">args</span> := <span class="id"
type="var">constr</span>:((<span class="id" type="var">boxer</span>
<span class="id" type="var">H'</span>)::<span class="id"
type="var">args</span>) <span class="id" type="keyword">in</span>\
   <span class="id" type="keyword">let</span> <span class="id"
type="var">args</span> := <span class="id"
type="var">args\_unfold\_head\_if\_not\_product</span> <span class="id"
type="var">args</span> <span class="id" type="keyword">in</span>\
   <span class="id" type="var">build\_app</span> <span class="id"
type="var">args</span> <span class="id" type="var">ltac</span>:(<span
class="id" type="keyword">fun</span> <span class="id"
type="var">R</span> ⇒ <span class="id" type="var">lets</span> <span
class="id" type="var">H</span>: <span class="id" type="var">R</span>);\
   <span class="id" type="tactic">clear</span> <span class="id"
type="var">H'</span>.\
\
 <span class="id" type="keyword">Ltac</span> <span class="id"
type="var">specializes\_base</span> <span class="id" type="var">H</span>
<span class="id" type="var">Ei</span> :=\
   <span class="id" type="var">specializes\_build</span> <span
class="id" type="var">H</span> <span class="id" type="var">Ei</span>;
<span class="id" type="var">fast\_rm\_inside</span> <span class="id"
type="var">Ei</span>.\
\
 <span class="id" type="keyword">Tactic Notation</span> "specializes"
<span class="id" type="var">hyp</span>(<span class="id"
type="var">H</span>) :=\
   <span class="id" type="var">specializes\_base</span> <span class="id"
type="var">H</span> (<span class="id" type="var">\_\_\_</span>).\
 <span class="id" type="keyword">Tactic Notation</span> "specializes"
<span class="id" type="var">hyp</span>(<span class="id"
type="var">H</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A</span>) :=\
   <span class="id" type="var">specializes\_base</span> <span class="id"
type="var">H</span> <span class="id" type="var">A</span>.\
 <span class="id" type="keyword">Tactic Notation</span> "specializes"
<span class="id" type="var">hyp</span>(<span class="id"
type="var">H</span>) <span class="id" type="var">constr</span>(<span
class="id" type="var">A1</span>)

</div>

</div>

</div>
